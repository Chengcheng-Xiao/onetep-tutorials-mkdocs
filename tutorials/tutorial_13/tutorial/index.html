<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Tutorials for ONTEP." name="description"/>
<meta content="ONETEP collective" name="author"/>
<link href="../../tutorial_12/tutorial/" rel="prev"/>
<link href="../../tutorial_14/tutorial/" rel="next"/>
<link href="../../../assets/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.5.3, mkdocs-material-9.5.4" name="generator"/>
<title>Tutorial 13 - ONETEP Tutorials</title>
<link href="../../../assets/stylesheets/main.50c56a3b.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link href="../../../stylesheets/extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="light" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#tutorial-13-ase-onetep-interface">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="ONETEP Tutorials" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="ONETEP Tutorials">
<img alt="logo" src="../../../assets/onetep-logo.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            ONETEP Tutorials
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Tutorial 13
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="light" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="dark" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"></path></svg>
</label>
</form>
<script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/Chengcheng-Xiao/onetep-tutorials-mkdocs" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</div>
<div class="md-source__repository">
    Chengcheng-Xiao/onetep-tutorials-mkdocs
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="ONETEP Tutorials" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="ONETEP Tutorials">
<img alt="logo" src="../../../assets/onetep-logo.svg"/>
</a>
    ONETEP Tutorials
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/Chengcheng-Xiao/onetep-tutorials-mkdocs" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</div>
<div class="md-source__repository">
    Chengcheng-Xiao/onetep-tutorials-mkdocs
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Tutorials
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_1/tutorial/">
<span class="md-ellipsis">
    Tutorial 1
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_4/tutorial/">
<span class="md-ellipsis">
    Tutorial 4
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_5/tutorial/">
<span class="md-ellipsis">
    Tutorial 5
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_6/tutorial/">
<span class="md-ellipsis">
    Tutorial 6
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_8/tutorial/">
<span class="md-ellipsis">
    Tutorial 8
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_9/tutorial/">
<span class="md-ellipsis">
    Tutorial 9
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_10/tutorial/">
<span class="md-ellipsis">
    Tutorial 10
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_11/tutorial/">
<span class="md-ellipsis">
    Tutorial 11
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_12/tutorial/">
<span class="md-ellipsis">
    Tutorial 12
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Tutorial 13
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Tutorial 13
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#preamble-download-links">
<span class="md-ellipsis">
      Preamble &amp; Download links
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
<span class="md-ellipsis">
      Introduction
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#environment-variables">
<span class="md-ellipsis">
      Environment variables
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pseudopotentials">
<span class="md-ellipsis">
      Pseudopotentials
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#onetep-calculator">
<span class="md-ellipsis">
      ONETEP Calculator
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#examples">
<span class="md-ellipsis">
      Examples
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_14/tutorial/">
<span class="md-ellipsis">
    Tutorial 14
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#preamble-download-links">
<span class="md-ellipsis">
      Preamble &amp; Download links
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
<span class="md-ellipsis">
      Introduction
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#environment-variables">
<span class="md-ellipsis">
      Environment variables
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pseudopotentials">
<span class="md-ellipsis">
      Pseudopotentials
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#onetep-calculator">
<span class="md-ellipsis">
      ONETEP Calculator
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#examples">
<span class="md-ellipsis">
      Examples
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset"><a class="md-content__button md-icon" download="Tutorial 13.pdf" href="index.pdf" title="Download as PDF"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14 2 6 6v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8m4 18V9h-5V4H6v16h12m-6-1-4-4h2.5v-3h3v3H16l-4 4Z"></path></svg></a>

<h1 id="tutorial-13-ase-onetep-interface">Tutorial 13: ASE ONETEP interface<a class="headerlink" href="#tutorial-13-ase-onetep-interface" title="Permanent link">¶</a></h1>
<p><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h11a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2Zm-.5-2a.5.5 0 0 0 .5.5h11a.5.5 0 0 0 .5-.5V4a.5.5 0 0 0-.5-.5H10a.5.5 0 0 0-.5.5ZM6.17 4.165a.75.75 0 0 1-.335 1.006c-.228.114-.295.177-.315.201a.035.035 0 0 0-.008.016.423.423 0 0 0-.012.112v13c0 .07.008.102.012.112a.03.03 0 0 0 .008.016c.02.024.087.087.315.201a.749.749 0 1 1-.67 1.342c-.272-.136-.58-.315-.81-.598C4.1 19.259 4 18.893 4 18.5v-13c0-.393.1-.759.355-1.073.23-.283.538-.462.81-.598a.75.75 0 0 1 1.006.336ZM2.15 5.624a.75.75 0 0 1-.274 1.025c-.15.087-.257.17-.32.245C1.5 6.96 1.5 6.99 1.5 7v10c0 .01 0 .04.056.106.063.074.17.158.32.245a.75.75 0 0 1-.752 1.298C.73 18.421 0 17.907 0 17V7c0-.907.73-1.42 1.124-1.65a.75.75 0 0 1 1.025.274Z"></path></svg></span> Version: all versions
<span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c-.34.34-.67.67-.68 1-.03.32.31.65.63.96.48.5.95.95.93 1.44-.02.49-.53 1-1.04 1.5l-4.13 4.14L15 14.66l4.25-4.24-.96-.96-1.42 1.41-3.75-3.75 3.84-3.83c.39-.39 1.04-.39 1.41 0l2.34 2.34c.39.37.39 1.02 0 1.41M3 17.25l9.56-9.57 3.75 3.75L6.75 21H3v-3.75Z"></path></svg></span> <a href="mailto:">Tom Demeyere</a>
<!-- · :octicons-tag-16: Post-processing | DFT -->
</p>
<h3 id="preamble-download-links">Preamble &amp; Download links<a class="headerlink" href="#preamble-download-links" title="Permanent link">¶</a></h3>
<p>Here is the tutorial for the ONETEP interface in ASE. 
It is a work in progress, but if you wish to give it a try, please
find the two files:</p>
<ul>
<li><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span><a href="../files/learn_ase_in_y_minutes.py">learn_ase_in_y_minutes.py</a></li>
<li><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span><a href="../files/onetep_interface.py">onetep_interface.py</a></li>
</ul>
<p>The first file is a general tutorial for people who are not used to ASE.
The second file is a small file that explains how to use the ONETEP interface
with ASE.</p>
<p>Below is the documentation for the ONETEP interface in ASE, as plan to be
included in the ASE documentation.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p><a href="http://www.onetep.org">ONETEP</a> is a linear-scaling density functional theory code which exploit the
near-sightness of the electronic density. It uses a set of atom-centered local 
orbitals (denoted NGWFs) which are optimised in situ to enable calculations 
with a minimal number of orbitals.</p>
<p>This interface makes it possible to use ONETEP as a calculator in ASE.
You need to have a copy of the ONETEP code (and an appropriate license) to use
this interface.</p>
<h2 id="environment-variables">Environment variables<a class="headerlink" href="#environment-variables" title="Permanent link">¶</a></h2>
<p>The environment variable <code>ASE_ONETEP_COMMAND</code> must hold the command
to invoke the ONETEP calculation. The variable must be a string with a link
to the ONETEP binary, and any other specific settings required for your
environment (srun, mpirun, ...)</p>
<p>You can setup this environment variable in your shell configuration file:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="w">  </span>$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">ASE_ONETEP_COMMAND</span><span class="o">=</span><span class="s2">"export OMP_NUM_THREADS=4; mpirun -n 6 ~/onetep/bin/onetep.arch"</span>
</span></code></pre></div></td></tr></table></div>
<p>Or within python itself:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1">  <span class="o">&gt;&gt;&gt;</span> <span class="n">environ</span><span class="p">[</span><span class="s2">"ASE_ONETEP_COMMAND"</span><span class="p">]</span><span class="o">=</span><span class="s2">"export OMP_NUM_THREADS=4; mpirun -n 6 ~/onetep/bin/onetep.arch"</span>
</span></code></pre></div></td></tr></table></div>
<p>ASE will automatically redirect stdout and stderr to the appropriate
files, namely "<span class="arithmatex">\(LABEL.out" and "\)</span>LABEL.err" where label is the name
used for your ONETEP calculations</p>
<h2 id="pseudopotentials">Pseudopotentials<a class="headerlink" href="#pseudopotentials" title="Permanent link">¶</a></h2>
<p>ONETEP accepts PAW datasets in the abinit format, and NCP pseudpotentials with formats 
USP and recpot. Support has recently been added for the upf format, for both PAW and NCPP potentials. Pseudopotentials are passed directly to the Onetep calculator
as a dictionary definition. If no pseudopotentials are passed ASE will
try to guess the files based on the element used and the pseudo_path variable. </p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1">    # Explicitly providing each path
</span><span id="__span-2-2">    calc = Onetep(pseudopotentials = {'H': '/path/to/pseudos/H.usp', 'O': '/path/to/pseudos/O.usp'})
</span><span id="__span-2-3">    # Using pseudo_path
</span><span id="__span-2-4">    calc = Onetep(pseudo_path = '/path/to/pseudos', pseudopotentials = {'H': 'H.usp', 'O': 'O.usp'})
</span><span id="__span-2-5">    # ASE will try to guess them
</span><span id="__span-2-6">    calc = Onetep(pseudo_path = '/path/to/pseudos')
</span></code></pre></div></td></tr></table></div>
<p>For ASE to correctly guess the pseudopotentials, it is best to use a pseudo_path that contains only one pseudopotential file for each element.</p>
<h2 id="onetep-calculator">ONETEP Calculator<a class="headerlink" href="#onetep-calculator" title="Permanent link">¶</a></h2>
<p>Simple calculations can be setup calling the Onetep calculator without any parameters,
in this case ONETEP's default parameters will be used. For more complex cases using the
keywords parameters is necessary. The 'keywords' parameters is a dictionary, in which each of the keys is a string that should be a ONETEP keyword, and the corresponding value is what you want to set that keyword to in the input.</p>
<h2 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">¶</a></h2>
<p>Here is an example python script which sets up a calculation on a water molecule: </p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1">    <span class="kn">from</span> <span class="nn">ase.build</span> <span class="kn">import</span> <span class="n">molecule</span>
</span><span id="__span-3-2">    <span class="kn">from</span> <span class="nn">ase.calculators.onetep</span> <span class="kn">import</span> <span class="n">Onetep</span>
</span><span id="__span-3-3">    <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">environ</span>
</span><span id="__span-3-4">
</span><span id="__span-3-5">    <span class="c1"># water molecule from ASE database, centered in a ~ 24 Å box</span>
</span><span id="__span-3-6">    <span class="n">wat</span> <span class="o">=</span> <span class="n">molecule</span><span class="p">(</span><span class="s1">'H2O'</span><span class="p">)</span>
</span><span id="__span-3-7">    <span class="n">wat</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
</span><span id="__span-3-8">    <span class="n">environ</span><span class="p">[</span><span class="s2">"ASE_ONETEP_COMMAND"</span><span class="p">]</span><span class="o">=</span><span class="s2">"export OMP_NUM_THREADS=8; mpirun -n 2 ~/onetep/bin/onetep.arch"</span>
</span><span id="__span-3-9">    <span class="c1"># Ouput will be in "water.out"</span>
</span><span id="__span-3-10">    <span class="n">calc</span> <span class="o">=</span> <span class="n">Onetep</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="s1">'water'</span><span class="p">,</span> <span class="n">xc</span> <span class="o">=</span> <span class="s1">'PBE'</span><span class="p">,</span> <span class="n">paw</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">pseudo_path</span> <span class="o">=</span> <span class="s1">'/path/to/pseudos'</span><span class="p">)</span>
</span><span id="__span-3-11">    <span class="n">wat</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">calc</span>
</span><span id="__span-3-12">    <span class="n">wat</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
<p>Here is a more complex example, this time setting up a Pt13 cluster and running a geometry optimisation on 64 cores: </p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1">    <span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">environ</span>
</span><span id="__span-4-2">
</span><span id="__span-4-3">    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="__span-4-4">
</span><span id="__span-4-5">    <span class="kn">from</span> <span class="nn">ase.build</span> <span class="kn">import</span> <span class="n">molecule</span>
</span><span id="__span-4-6">    <span class="kn">from</span> <span class="nn">ase.calculators.onetep</span> <span class="kn">import</span> <span class="n">Onetep</span>
</span><span id="__span-4-7">    <span class="kn">from</span> <span class="nn">ase.cluster</span> <span class="kn">import</span> <span class="n">Octahedron</span>
</span><span id="__span-4-8">    <span class="kn">from</span> <span class="nn">ase.optimize.sciopt</span> <span class="kn">import</span> <span class="n">SciPyFminBFGS</span>
</span><span id="__span-4-9">    <span class="c1"># Pt13 from ase.cluster</span>
</span><span id="__span-4-10">    <span class="n">nano</span> <span class="o">=</span> <span class="n">Octahedron</span><span class="p">(</span><span class="s1">'Pt'</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-4-11">    <span class="n">nano</span><span class="o">.</span><span class="n">set_cell</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">12</span><span class="p">)</span>
</span><span id="__span-4-12">    <span class="n">nano</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
</span><span id="__span-4-13">
</span><span id="__span-4-14">    <span class="n">label</span> <span class="o">=</span> <span class="s1">'pt13'</span>
</span><span id="__span-4-15">
</span><span id="__span-4-16">    <span class="n">environ</span><span class="p">[</span><span class="s2">"ASE_ONETEP_COMMAND"</span><span class="p">]</span><span class="o">=</span><span class="s2">"export OMP_NUM_THREADS=8; mpirun -n 8 ~/onetep/bin/onetep.arch"</span>
</span><span id="__span-4-17">
</span><span id="__span-4-18">    <span class="c1"># ONETEP default are atomic units, one can specify 'cutoff_energy' : '600 eV' if needed.</span>
</span><span id="__span-4-19">    <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-4-20">        <span class="s1">'xc'</span> <span class="p">:</span> <span class="s1">'rpbe'</span><span class="p">,</span>
</span><span id="__span-4-21">        <span class="s1">'do_properties'</span> <span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-4-22">        <span class="s1">'cutoff_energy'</span> <span class="p">:</span> <span class="mi">35</span><span class="p">,</span>
</span><span id="__span-4-23">        <span class="s1">'output_detail'</span><span class="p">:</span> <span class="s1">'verbose'</span><span class="p">,</span>
</span><span id="__span-4-24">        <span class="s1">'elec_energy_tol'</span><span class="p">:</span> <span class="mf">1.0e-5</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">),</span>
</span><span id="__span-4-25">    <span class="p">}</span>
</span><span id="__span-4-26">
</span><span id="__span-4-27">    <span class="c1"># Ouput will be in "pt13.out", </span>
</span><span id="__span-4-28">    <span class="c1"># append = True will not overwrite file at each step</span>
</span><span id="__span-4-29">    <span class="n">calc</span> <span class="o">=</span> <span class="n">Onetep</span><span class="p">(</span>
</span><span id="__span-4-30">        <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="p">,</span>
</span><span id="__span-4-31">        <span class="n">edft</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-4-32">        <span class="n">append</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-4-33">        <span class="n">pseudo_path</span> <span class="o">=</span> <span class="s1">'/path/to/pseudos'</span><span class="p">,</span> 
</span><span id="__span-4-34">        <span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span><span class="p">)</span>
</span><span id="__span-4-35">
</span><span id="__span-4-36">    <span class="n">nanoparticle</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">calc</span>
</span><span id="__span-4-37">
</span><span id="__span-4-38">    <span class="n">opt</span> <span class="o">=</span> <span class="n">SciPyFminBFGS</span><span class="p">(</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">nano</span><span class="p">,</span> <span class="n">trajectory</span> <span class="o">=</span> <span class="n">label</span> <span class="o">+</span> <span class="s2">".traj"</span><span class="p">,</span> <span class="n">logfile</span> <span class="o">=</span> <span class="n">label</span> <span class="o">+</span> <span class="s2">".log"</span><span class="p">)</span>
</span><span id="__span-4-39">    <span class="n">opt</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fmax</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
<p>Here is an example of setting up an EELS and LDOS calculation on an N-substituted graphene sheet,
demonstrating several more advanced functionalities (eg tags, species groups, and overrides to
pseudopotentials and atomic solver strings): </p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1">    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="__span-5-2">
</span><span id="__span-5-3">    <span class="kn">from</span> <span class="nn">ase.build</span> <span class="kn">import</span> <span class="n">graphene_nanoribbon</span>
</span><span id="__span-5-4">    <span class="kn">from</span> <span class="nn">ase.calculators.onetep</span> <span class="kn">import</span> <span class="n">Onetep</span>
</span><span id="__span-5-5">    <span class="kn">from</span> <span class="nn">ase.io</span> <span class="kn">import</span> <span class="n">write</span>
</span><span id="__span-5-6">    <span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">norm</span>
</span><span id="__span-5-7">    <span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">choice</span>
</span><span id="__span-5-8">
</span><span id="__span-5-9">    <span class="n">sheet</span> <span class="o">=</span> <span class="n">graphene_nanoribbon</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">'zigzag'</span><span class="p">,</span> <span class="n">vacuum</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="__span-5-10">
</span><span id="__span-5-11">    <span class="c1"># Get all distances to center of mass</span>
</span><span id="__span-5-12">    <span class="n">com</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">get_center_of_mass</span><span class="p">()</span>
</span><span id="__span-5-13">    <span class="n">distances_to_com</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">positions</span> <span class="o">-</span> <span class="n">com</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-5-14">
</span><span id="__span-5-15">    <span class="c1"># Find atoms close to com and change one randomly to N</span>
</span><span id="__span-5-16">    <span class="n">p</span><span class="p">,</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">distances_to_com</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="__span-5-17">    <span class="n">to_nitro</span> <span class="o">=</span> <span class="n">choice</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="__span-5-18">    <span class="n">sheet</span><span class="p">[</span><span class="n">to_nitro</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span> <span class="o">=</span> <span class="s1">'N'</span>
</span><span id="__span-5-19">
</span><span id="__span-5-20">    <span class="n">shell_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">])</span>
</span><span id="__span-5-21">
</span><span id="__span-5-22">    <span class="n">tags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sheet</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="__span-5-23">
</span><span id="__span-5-24">    <span class="c1"># We want to tag atoms that are close to the introduced nitrogen</span>
</span><span id="__span-5-25">    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">rad</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">shell_rad</span><span class="p">)):</span>
</span><span id="__span-5-26">        <span class="c1"># All distances N-C</span>
</span><span id="__span-5-27">        <span class="n">dist</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">sheet</span><span class="p">[</span><span class="n">to_nitro</span><span class="p">]</span><span class="o">.</span><span class="n">position</span> <span class="o">-</span> <span class="n">sheet</span><span class="o">.</span><span class="n">get_positions</span><span class="p">(),</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-5-28">        <span class="c1"># Which ones are closest to rad?</span>
</span><span id="__span-5-29">        <span class="n">p</span><span class="p">,</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">dist</span> <span class="o">&lt;</span> <span class="n">rad</span><span class="p">)</span>
</span><span id="__span-5-30">        <span class="c1"># Cannot be the nitrogen itself</span>
</span><span id="__span-5-31">        <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">p</span> <span class="o">!=</span> <span class="n">to_nitro</span><span class="p">]</span>
</span><span id="__span-5-32">        <span class="c1"># Tags them</span>
</span><span id="__span-5-33">        <span class="n">tags</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">shell_rad</span><span class="p">)</span> <span class="o">-</span> <span class="n">idx</span>
</span><span id="__span-5-34">
</span><span id="__span-5-35">    <span class="n">sheet</span><span class="o">.</span><span class="n">set_tags</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span>
</span><span id="__span-5-36">
</span><span id="__span-5-37">    <span class="n">tags</span> <span class="o">=</span> <span class="p">[</span><span class="s1">''</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">]</span>
</span><span id="__span-5-38">
</span><span id="__span-5-39">    <span class="n">species</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">get_chemical_symbols</span><span class="p">(),</span> <span class="n">tags</span><span class="p">))</span>
</span><span id="__span-5-40">
</span><span id="__span-5-41">    <span class="n">keywords</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-5-42">        <span class="s1">'species_core_wf'</span> <span class="p">:</span> <span class="p">[</span><span class="s1">'N /path/to/pseudo/corehole.abinit'</span><span class="p">],</span>
</span><span id="__span-5-43">        <span class="s1">'species_solver'</span> <span class="p">:</span> <span class="p">[</span><span class="s1">'N SOLVE conf=1s1 2p4'</span><span class="p">],</span>
</span><span id="__span-5-44">        <span class="s1">'pseudo_path'</span><span class="p">:</span> <span class="s1">'/Users/tomdm/PseudoPotentials/SSSP_1.2.1'</span><span class="p">,</span>
</span><span id="__span-5-45">        <span class="s1">'xc'</span> <span class="p">:</span> <span class="s1">'PBE'</span><span class="p">,</span>
</span><span id="__span-5-46">        <span class="s1">'paw'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-5-47">        <span class="s1">'do_properties'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-5-48">        <span class="s1">'cutoff_energy'</span> <span class="p">:</span> <span class="s1">'500 eV'</span><span class="p">,</span>
</span><span id="__span-5-49">        <span class="s1">'species_ldos_groups'</span><span class="p">:</span> <span class="n">species</span><span class="p">,</span>
</span><span id="__span-5-50">        <span class="s1">'task'</span> <span class="p">:</span> <span class="s1">'GeometryOptimization'</span>
</span><span id="__span-5-51">    <span class="p">}</span>
</span><span id="__span-5-52">
</span><span id="__span-5-53">    <span class="n">calc</span> <span class="o">=</span> <span class="n">Onetep</span><span class="p">(</span>
</span><span id="__span-5-54">        <span class="n">label</span> <span class="o">=</span> <span class="s1">'N_doped_graphene_001'</span><span class="p">,</span>
</span><span id="__span-5-55">        <span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span>
</span><span id="__span-5-56">    <span class="p">)</span>
</span><span id="__span-5-57">
</span><span id="__span-5-58">    <span class="c1"># Checking the input before running the calculation</span>
</span><span id="__span-5-59">    <span class="n">write</span><span class="p">(</span><span class="s1">'to_check.dat'</span><span class="p">,</span> <span class="n">sheet</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">'onetep-in'</span><span class="p">,</span> <span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span><span class="p">)</span>
</span><span id="__span-5-60">
</span><span id="__span-5-61">    <span class="n">sheet</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">calc</span>
</span><span id="__span-5-62">    <span class="c1"># Will actually run the geometry optimisation</span>
</span><span id="__span-5-63">    <span class="c1"># using ONETEP internal BFGS</span>
</span><span id="__span-5-64">    <span class="n">sheet</span><span class="o">.</span><span class="n">get_potential_energy</span><span class="p">()</span>
</span></code></pre></div></td></tr></table></div>
<p>Quickly restart with solvation effect using the soft sphere model </p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1">    <span class="kn">from</span> <span class="nn">ase.io</span> <span class="kn">import</span> <span class="n">read</span>
</span><span id="__span-6-2">    <span class="kn">from</span> <span class="nn">ase.io.onetep</span> <span class="kn">import</span> <span class="n">get_onetep_keywords</span>
</span><span id="__span-6-3">
</span><span id="__span-6-4">    <span class="c1"># Read from the previous run...</span>
</span><span id="__span-6-5">    <span class="n">optimized_sheet</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="s2">"N_doped_graphene_001.out"</span><span class="p">)</span>
</span><span id="__span-6-6">
</span><span id="__span-6-7">    <span class="c1"># Function to retrieve keywords dict from input file...</span>
</span><span id="__span-6-8">    <span class="n">keywords</span> <span class="o">=</span> <span class="n">get_onetep_keywords</span><span class="p">(</span><span class="s1">'N_doped_graphene_001.dat'</span><span class="p">)</span>
</span><span id="__span-6-9">
</span><span id="__span-6-10">    <span class="c1"># We add solvation keywords</span>
</span><span id="__span-6-11">    <span class="n">keywords</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
</span><span id="__span-6-12">        <span class="p">{</span>
</span><span id="__span-6-13">        <span class="s1">'is_implicit_solvent'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-6-14">        <span class="s1">'is_include_apolar'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-6-15">        <span class="s1">'is_smeared_ion_rep'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-6-16">        <span class="s1">'is_dielectric_model'</span><span class="p">:</span> <span class="s1">'fix_cavity'</span><span class="p">,</span>
</span><span id="__span-6-17">        <span class="s1">'is_dielectric_function'</span> <span class="p">:</span> <span class="s1">'soft_sphere'</span>
</span><span id="__span-6-18">        <span class="p">}</span>
</span><span id="__span-6-19">    <span class="p">)</span>
</span><span id="__span-6-20">
</span><span id="__span-6-21">    <span class="n">optimized_sheet</span><span class="o">.</span><span class="n">calc</span> <span class="o">=</span> <span class="n">Onetep</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</span><span id="__span-6-22">
</span><span id="__span-6-23">    <span class="o">...</span>
</span></code></pre></div></td></tr></table></div>

</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 2024 ONETEP Collective
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.c011b7c0.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../../assets/javascripts/bundle.7389ff0e.min.js"></script>
<script src="../../../javascripts/mathjax.js"></script>
<script src="../../../javascripts/mkdocs_exporter.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
<script src="../../../javascripts/katex.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
</body>
</html>