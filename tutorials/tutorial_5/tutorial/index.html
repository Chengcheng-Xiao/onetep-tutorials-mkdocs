<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Tutorials for ONTEP." name="description"/>
<meta content="ONETEP collective" name="author"/>
<link href="../../tutorial_4/tutorial/" rel="prev"/>
<link href="../../tutorial_6/tutorial/" rel="next"/>
<link href="../../../assets/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.5.3, mkdocs-material-9.5.4" name="generator"/>
<title>Tutorial 5 - ONETEP Tutorials</title>
<link href="../../../assets/stylesheets/main.50c56a3b.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link href="../../../stylesheets/extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="light" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#tutorial-5-analysis-and-visualization">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="ONETEP Tutorials" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="ONETEP Tutorials">
<img alt="logo" src="../../../assets/onetep-logo.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            ONETEP Tutorials
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Tutorial 5
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="light" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="dark" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"></path></svg>
</label>
</form>
<script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/Chengcheng-Xiao/onetep-tutorials-mkdocs" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</div>
<div class="md-source__repository">
    Chengcheng-Xiao/onetep-tutorials-mkdocs
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="ONETEP Tutorials" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="ONETEP Tutorials">
<img alt="logo" src="../../../assets/onetep-logo.svg"/>
</a>
    ONETEP Tutorials
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/Chengcheng-Xiao/onetep-tutorials-mkdocs" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</div>
<div class="md-source__repository">
    Chengcheng-Xiao/onetep-tutorials-mkdocs
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Tutorials
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_1/tutorial/">
<span class="md-ellipsis">
    Tutorial 1
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_4/tutorial/">
<span class="md-ellipsis">
    Tutorial 4
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Tutorial 5
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Tutorial 5
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
<span class="md-ellipsis">
      Introduction
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#density-spin-density-kohn-sham-orbitals-and-the-electrostatic-potential-for-ch3">
<span class="md-ellipsis">
      Density, spin density, Kohn-Sham orbitals and the electrostatic potential for CH3
    </span>
</a>
<nav aria-label="Density, spin density, Kohn-Sham orbitals and the electrostatic potential for CH3" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#prepreation">
<span class="md-ellipsis">
      Prepreation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#visualisation-ionic-positions">
<span class="md-ellipsis">
      Visualisation [ionic positions]
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#visualisation-spin-density">
<span class="md-ellipsis">
      Visualisation [spin density]
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#visualisation-kohn-sham-orbtials">
<span class="md-ellipsis">
      Visualisation [Kohn-Sham orbtials]
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#visualisation-local-potential">
<span class="md-ellipsis">
      Visualisation [local potential]
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#visualising-ngwfs-and-nnhos-for-c2sih6">
<span class="md-ellipsis">
      Visualising NGWFs and NNHOs for C2SiH6
    </span>
</a>
<nav aria-label="Visualising NGWFs and NNHOs for C2SiH6" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#prepreation_1">
<span class="md-ellipsis">
      Prepreation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#visualisation-ngwf-and-nnho">
<span class="md-ellipsis">
      Visualisation [NGWF and NNHO]
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nanostructure">
<span class="md-ellipsis">
      Nanostructure
    </span>
</a>
<nav aria-label="Nanostructure" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#prepreation_2">
<span class="md-ellipsis">
      Prepreation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#visualisation">
<span class="md-ellipsis">
      Visualisation
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_6/tutorial/">
<span class="md-ellipsis">
    Tutorial 6
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_8/tutorial/">
<span class="md-ellipsis">
    Tutorial 8
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_9/tutorial/">
<span class="md-ellipsis">
    Tutorial 9
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_10/tutorial/">
<span class="md-ellipsis">
    Tutorial 10
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_11/tutorial/">
<span class="md-ellipsis">
    Tutorial 11
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_12/tutorial/">
<span class="md-ellipsis">
    Tutorial 12
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_13/tutorial/">
<span class="md-ellipsis">
    Tutorial 13
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_14/tutorial/">
<span class="md-ellipsis">
    Tutorial 14
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
<span class="md-ellipsis">
      Introduction
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#density-spin-density-kohn-sham-orbitals-and-the-electrostatic-potential-for-ch3">
<span class="md-ellipsis">
      Density, spin density, Kohn-Sham orbitals and the electrostatic potential for CH3
    </span>
</a>
<nav aria-label="Density, spin density, Kohn-Sham orbitals and the electrostatic potential for CH3" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#prepreation">
<span class="md-ellipsis">
      Prepreation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#visualisation-ionic-positions">
<span class="md-ellipsis">
      Visualisation [ionic positions]
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#visualisation-spin-density">
<span class="md-ellipsis">
      Visualisation [spin density]
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#visualisation-kohn-sham-orbtials">
<span class="md-ellipsis">
      Visualisation [Kohn-Sham orbtials]
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#visualisation-local-potential">
<span class="md-ellipsis">
      Visualisation [local potential]
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#visualising-ngwfs-and-nnhos-for-c2sih6">
<span class="md-ellipsis">
      Visualising NGWFs and NNHOs for C2SiH6
    </span>
</a>
<nav aria-label="Visualising NGWFs and NNHOs for C2SiH6" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#prepreation_1">
<span class="md-ellipsis">
      Prepreation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#visualisation-ngwf-and-nnho">
<span class="md-ellipsis">
      Visualisation [NGWF and NNHO]
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nanostructure">
<span class="md-ellipsis">
      Nanostructure
    </span>
</a>
<nav aria-label="Nanostructure" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#prepreation_2">
<span class="md-ellipsis">
      Prepreation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#visualisation">
<span class="md-ellipsis">
      Visualisation
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset"><a class="md-content__button md-icon" download="Tutorial 5.pdf" href="index.pdf" title="Download as PDF"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14 2 6 6v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8m4 18V9h-5V4H6v16h12m-6-1-4-4h2.5v-3h3v3H16l-4 4Z"></path></svg></a>

<h1 id="tutorial-5-analysis-and-visualization">Tutorial 5: Analysis and visualization<a class="headerlink" href="#tutorial-5-analysis-and-visualization" title="Permanent link">¶</a></h1>
<p><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h11a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2Zm-.5-2a.5.5 0 0 0 .5.5h11a.5.5 0 0 0 .5-.5V4a.5.5 0 0 0-.5-.5H10a.5.5 0 0 0-.5.5ZM6.17 4.165a.75.75 0 0 1-.335 1.006c-.228.114-.295.177-.315.201a.035.035 0 0 0-.008.016.423.423 0 0 0-.012.112v13c0 .07.008.102.012.112a.03.03 0 0 0 .008.016c.02.024.087.087.315.201a.749.749 0 1 1-.67 1.342c-.272-.136-.58-.315-.81-.598C4.1 19.259 4 18.893 4 18.5v-13c0-.393.1-.759.355-1.073.23-.283.538-.462.81-.598a.75.75 0 0 1 1.006.336ZM2.15 5.624a.75.75 0 0 1-.274 1.025c-.15.087-.257.17-.32.245C1.5 6.96 1.5 6.99 1.5 7v10c0 .01 0 .04.056.106.063.074.17.158.32.245a.75.75 0 0 1-.752 1.298C.73 18.421 0 17.907 0 17V7c0-.907.73-1.42 1.124-1.65a.75.75 0 0 1 1.025.274Z"></path></svg></span> Version: all versions
<span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c-.34.34-.67.67-.68 1-.03.32.31.65.63.96.48.5.95.95.93 1.44-.02.49-.53 1-1.04 1.5l-4.13 4.14L15 14.66l4.25-4.24-.96-.96-1.42 1.41-3.75-3.75 3.84-3.83c.39-.39 1.04-.39 1.41 0l2.34 2.34c.39.37.39 1.02 0 1.41M3 17.25l9.56-9.57 3.75 3.75L6.75 21H3v-3.75Z"></path></svg></span>
<a href="mailto:j.dziedzic@soton.ac.uk">Jacek Dziedzic</a>;
<a href="mailto:c.skylaris@soton.ac.uk">Chris-Kriton Skylaris</a></p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p>This tutorial demonstrates how to:</p>
<ul>
<li>Use ONETEP to calculate various electronic properties,</li>
<li>Instruct ONETEP to generate files needed for later visualization of orbitals, electronic densities and potentials,</li>
<li>Visualize these properties using VMD <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>,</li>
<li>Set up and run a calculation on a nanostructure using a cut-off for the density kernel.</li>
</ul>
<h2 id="density-spin-density-kohn-sham-orbitals-and-the-electrostatic-potential-for-ch3">Density, spin density, Kohn-Sham orbitals and the electrostatic potential for CH<sub>3</sub><a class="headerlink" href="#density-spin-density-kohn-sham-orbitals-and-the-electrostatic-potential-for-ch3" title="Permanent link">¶</a></h2>
<p>In this part we will perform a calculation on the CH<span class="arithmatex">\(_3\)</span> radical:</p>
<figure>
<p><img _="," alt="image-1" class="center" src="../files/T5_CH3.png" width="20%"/>
</p>
<figcaption>Fig.1: The CH3 radical. Visualization in VM.</figcaption>
</figure>
<!-- .. _Figure fig:CH3:
.. figure:: _static/tutorial_5/T5_CH3.png
   :alt: The CH3 radical. Visualization in VMD.
   :name: fig:T5_CH3
   :width: 25.0%
   :align: center
   :target: _static/tutorial_5/T5_CH3.png -->
<p>As this molecule contains an odd number of electrons we need to perform a spin-polarised (unrestricted)
calculation. In ONETEP this is achieved by optimising a different density kernel <span class="arithmatex">\(K\)</span> for the "up"(<span class="arithmatex">\(\uparrow\)</span>) and the "down"(<span class="arithmatex">\(\downarrow\)</span>) spin:</p>
<div class="arithmatex">\[
\rho\left(\mathbf{r}, \mathbf{r}^{\prime}\right)=\sum_{\alpha \beta} \phi_\alpha(\mathbf{r}) K^{\alpha \beta(\uparrow)} \phi_\beta^*\left(\mathbf{r}^{\prime}\right)+\sum_{\alpha \beta} \phi_\alpha(\mathbf{r}) K^{\alpha \beta(\downarrow)} \phi_\beta^*\left(\mathbf{r}^{\prime}\right)
\]</div>
<!-- .. _Figure fig:up_down_spin:
.. figure:: _static/tutorial_5/T5_up_down_spin.png
   :alt: The density matrix for an unrestricted (spin-polarised) calculation.
   :name: fig:T5_up_down_spin
   :width: 75.0%
   :align: center
   :target: _static/tutorial_5/T5_up_down_spin.png -->
<h3 id="prepreation">Prepreation<a class="headerlink" href="#prepreation" title="Permanent link">¶</a></h3>
<p>The ONETEP input for this calcualtion are:</p>
<ul>
<li>Tnput: <a href="../files/methyl.dat"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span>methyl.dat</a></li>
<li>Geometry (in angstroem): <a href="../files/methyl.pdb"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span>methyl.pdb</a></li>
</ul>
<p>Note that the input file contains the coordinates as well (in atomic units), but not in a form directly
readable by visualization packages. The <code>.pdb</code> file can be directly visualized in VMD.</p>
<p>The input file specifies a single point energy calculation (<code>TASK SINGLEPOINT</code>) with a psinc kinetic energy cutoff of 800 eV (<code>CUTOFF_ENERGY 800.0 eV</code>),
the Perdew-Zunger variant of the LSDA exchange-correlation functional (<code>XC_FUNCTIONAL CAPZ</code>)
and the spin-polarised option (<code>SPINPOLARIZED TRUE</code>). Also notice the input flag <code>DO_PROPERTIES TRUE</code>,
which proceeds with the calculation of various electronic properties at the end of the single point
energy calculation.</p>
<p>Run the input, redirecting the output to a file such as <code>methyl.out</code> (we also provide a reference
<a href="../files/methyl.out"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span>methyl.out</a> file). 
The calculation should take a minute or two to run. </p>
<h3 id="visualisation-ionic-positions">Visualisation [ionic positions]<a class="headerlink" href="#visualisation-ionic-positions" title="Permanent link">¶</a></h3>
<p>Once it completes, you will notice that a number of <code>.cube</code> files have been created,
including the file <a href="../files/methyl_spindensity.cube"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span>methyl_spindensity.cube</a>.
Let us examine this first. ONETEP can output volumetric data such as spin densities, charge densities,
potentials, etc. There are three formats to choose from:</p>
<ul>
<li>Gaussian <code>.cube</code> format (<code>CUBE_FORMAT TRUE</code>)</li>
<li>Materials Studio <code>.grd</code> format (<code>GRD_FORMAT TRUE</code>)</li>
<li>OpenDX <code>.dx</code> format (<code>DX_FORMAT TRUE</code>). </li>
</ul>
<p>The <code>.cube</code> format has the advantage of having the ionic positions output in addition to the volumetric data. 
In this tutorial we will use the <code>.cube</code> format which can be viewed with a number of free molecular visualisation
programs. The instructions that follow are assuming that the VMD program can be used to visualize
the files but in priciple you can use any other software that can display <code>.cube</code> files (such as
VESTA, Molekel, gOpenMol, XCrySDens, etc).</p>
<p>Start VMD by typing <code>vmd</code> in the terminal, use <code>File/New molecule/Browse</code> to find
<code>methyl_spindensity.cube</code>, then click on <code>Load</code> to load the molecule. You should
be able to see a crude, line-based representation of the molecule in a separate window.
You can now get rid of the <code>Molecule file browser</code> window. Choosing <code>Graphics/Representations...</code>
opens another window which lets you control the look of your molecule. In this window,
change the <code>Drawing Method</code> from <code>Lines</code> to <code>CPK</code>, which will render your molecule in a
ball-and-stick fashion, with the customary colouring <sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup>. Increase both <code>Sphere Resolution</code> and
<code>Bond Resolution</code> (30 is a good value) to get rid of the jagged edges. You may wish to
adjust <code>Sphere Scale</code> and <code>Bond Radius</code> to your liking as well.</p>
<p>Try dragging with your mouse over the window that shows the molecule to rotate it.
Try scrolling the mouse wheel to get closer or further away from the molecule. You may press
the <code>=</code> key at any time to reset the view. Pressing the <code>T</code> key will get you to <code>Translate Mode</code>,
where dragging with the mouse translates the molecule, instead of rotating it. To go back to
<code>Rotate Mode</code>, press <code>R</code>. If your mouse lacks the scroll wheel, pressing <code>S</code> to go to
<code>Scale Mode</code> might be of use. You should be able to obtain a representation similar to the one shown here.</p>
<figure>
<p><img alt="image-2" class="center" src="../files/T5_CH3_vmd.png" width='20%",'/>
</p>
<figcaption>Fig.2: The CH3 radical visualized in VMD with a ball-and-stick representation.</figcaption>
</figure>
<!-- .. _Figure fig:CH3_vmd:
.. figure:: _static/tutorial_5/T5_CH3_vmd.png
   :alt: The CH3 radical visualized in VMD with a ball-and-stick representation.
   :name: fig:T5_CH3_vmd.png
   :width: 50.0%
   :align: center
   :target: _static/tutorial_5/T5_CH3_vmd.png -->
<h3 id="visualisation-spin-density">Visualisation [spin density]<a class="headerlink" href="#visualisation-spin-density" title="Permanent link">¶</a></h3>
<p>So far we've only looked at the nuclei in the system. Let's try some electronic properties,
starting from the spin density which we have already loaded, but not visualized yet.
A neat thing about VMD is that you can use several representations at once.
Thus, we can overlay the spin density isosurfaces on top of the CPK representation of the ions.
In the <code>Graphics/Representations...</code> window click on <code>Create Rep</code>. This will clone the
CPK representation, leaving you with two identical representations. Now change one of
them to <code>Isosurface</code>. Not much will appear initially, because the default way of showing
the isosurface is by using <em>points</em>. This is computationally cheap, but visually so as well.
You can change this under <code>Draw</code>, by choosing <code>Solid Surface</code>. <em>Before you do it</em>,
however, make sure to move the <code>Isovalue</code> slider to something different than the
default 0.0 (or type a value in the box). This is because there is a huge number of
points in our system (some 400000) where the spin density is exactly or almost exactly zero
(everywhere outside our molecule). Trying to draw a surface through these points usually
confuses VMD to the point of crashing or at least stuttering. For this reason it is best to
pick any value other than the default of 0.0 to start from, before choosing <code>Solid Surface</code>.</p>
<p>Experiment with the settings (<code>Coloring Method</code>, <code>Material</code>, <code>Isovalue</code>) to get a feel for
how they work. It makes sense to set <code>Coloring Method</code> to <code>ColorID</code> here, as this lets us
to manually pick a colour for the isosurface (from the drop-down box near <code>ColorID</code>).
After some adjustments you should obtain an isosurface similar to the one shown here.
Do not worry if you cannot get the transparency right - it's only possible when you render
"production quality" images, think of what you see as a draft.</p>
<figure>
<p><img alt="image-3" class="center" src="../files/T5_CH3_vmd2.png" width='20%",'/>
</p>
<figcaption>Fig.3: The spin density of the CH3 radical visualized in VMD.</figcaption>
</figure>
<!-- .. _Figure fig:CH3_vmd2:
.. figure:: _static/tutorial_5/T5_CH3_vmd2.png
   :alt: The spin density of the CH3 radical visualized in VMD.
   :name: fig:T5_CH3_vmd2.png
   :width: 50.0%
   :align: center
   :target: _static/tutorial_5/T5_CH3_vmd2.png -->
<p>What we have obtained is the textbook picture of the spin density of a methyl radical.
It has positive as well as negative regions which is a consequence of the fact that
the spatial parts of the Kohn-Sham orbitals for each spin are allowed to be different,
even for doubly occupied states.</p>
<h3 id="visualisation-kohn-sham-orbtials">Visualisation [Kohn-Sham orbtials]<a class="headerlink" href="#visualisation-kohn-sham-orbtials" title="Permanent link">¶</a></h3>
<p>The properties calculation also produces <em>Kohn-Sham orbitals</em>. Their energies for each
spin are printed in the output file (try to find them, they are towards the very end,
copy them into the table below) and <code>.cube</code> files for the squares of some of the
orbitals are also produced. HOMO orbitals are written, separately for each spin,
to <a href="../files/methyl_HOMO_DN.cube"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span>methyl_HOMO_DN.cube</a> and
<a href="../files/methyl_HOMO_UP.cube"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span>methyl_HOMO_UP.cube</a>, and
their LUMO counterparts to <a href="../files/methyl_LUMO_DN.cube"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span>methyl_LUMO_DN.cube</a> and
<a href="../files/methyl_LUMO_UP.cube"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span>methyl_LUMO_UP.cube</a>.
Similarly named files contain the orbitals just below the HOMO and just above the LUMO (not provided
here, but generated during the calculation).</p>
<figure>
<p><img alt="image-4" class="center" src="../files/T5_CH3_table.png" width='80%",'/>
</p>
<figcaption>Table 1: Fill this table with the data found in the calculation output.</figcaption>
</figure>
<!-- .. _Figure fig:CH3_table:
.. figure:: _static/tutorial_5/T5_CH3_table.png
   :alt: Fill this table with the data found in the calculation output.
   :name: fig:T5_CH3_table.png
   :width: 90.0%
   :align: center
   :target: _static/tutorial_5/T5_CH3_table.png -->
<h3 id="visualisation-local-potential">Visualisation [local potential]<a class="headerlink" href="#visualisation-local-potential" title="Permanent link">¶</a></h3>
<p>Finally, let's try visualizing the local potential [sum of the ionic, Hartree (Coulomb) and XC potentials] with a contour plot,
which is written out to <a href="../files/methyl_potential.cube"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span>methyl_potential.cube</a>.</p>
<p>Isosurface plots of potentials can be obtained similarly to the isosurface plots of densities.
This can be accomplished by choosing <code>VolumeSlice</code> for
<code>Drawing Method</code>. Try playing with <code>Slice Axis</code> and <code>Slice Offset</code> to get the hang of it.
Admittedly, the quality of the contour plot is not too good, even if you set <code>Render Quality</code> to
<code>High</code>. It is improved, however, when you create a production image. Try obtaining a
composite CPK + isodensity + contour plot similar to the one shown here.</p>
<figure>
<p><img alt="image-5" class="center" src="../files/T5_CH3_vmd3.png" width='30%",'/>
</p>
<figcaption>Fig.4: The local potential of the CH3 radical visualized in VMD.</figcaption>
</figure>
<!-- .. _Figure fig:CH3_vmd3:
.. figure:: _static/tutorial_5/T5_CH3_vmd3.png
   :alt: The local potential of the CH3 radical visualized in VMD.
   :name: fig:T5_CH3_vmd3.png
   :width: 50.0%
   :align: center
   :target: _static/tutorial_5/T5_CH3_vmd3.png -->
<h2 id="visualising-ngwfs-and-nnhos-for-c2sih6">Visualising NGWFs and NNHOs for C<sub>2</sub>SiH<sub>6</sub><a class="headerlink" href="#visualising-ngwfs-and-nnhos-for-c2sih6" title="Permanent link">¶</a></h2>
<p>In this example we will perform two sets of calculations on the C<span class="arithmatex">\(_2\)</span>SiH<span class="arithmatex">\(_6\)</span> molecule:</p>
<figure>
<p><img alt="image-6" class="center" src="../files/T5_C2SiH6.png" width='25%",'/>
</p>
<figcaption>Fig.5: The C2SiH6 molecule. Visualization in VMD.</figcaption>
</figure>
<!-- .. _Figure fig:C2SiH6:
.. figure:: _static/tutorial_5/T5_C2SiH6.png
   :alt: The C2SiH6 molecule. Visualization in VMD.
   :name: fig:T5_C2SiH6
   :width: 25.0%
   :align: center
   :target: _static/tutorial_5/T5_CH2SiH6.png -->
<h3 id="prepreation_1">Prepreation<a class="headerlink" href="#prepreation_1" title="Permanent link">¶</a></h3>
<p>The ONETEP input for this calcualtion are:</p>
<ul>
<li>Input file 1: <a href="../files/C2SiH6_NGWF.dat"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span>C2SiH6_NGWF.dat</a></li>
<li>Input file 2: <a href="../files/C2SiH6_NNHO.dat"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span>C2SiH6_NNHO.dat</a></li>
</ul>
<p>Compared to the previous input file, the first input file has similar parameters (and, thus, keywords).
However it also contains the <code>WRITE_NGWF_PLOT TRUE</code> keyword that allows output of selected NGWFs in the scalarfield formats we
discussed earlier (<code>.cube</code> by default). The NGWFs that will be outputted are selected by the
<code>species_ngwf_plot</code> block in which the <em>species</em> of atoms whose NGWFs are to be outputted are
listed. In this example we output NGWFs of the Si atom and of the first H and C atoms (as written
in the input coordinates). </p>
<p>The second input file contains the additional keyword <code>NNHO TRUE</code> which instructs ONETEP to perform a same-centre rotation of the
NGWFs to transform them to non-orthogonal natural hybrid orbitals (NNHOs). These contain the
same information as the NGWFs but are more "natural" as they conform with chemical concepts,
such as being directed towards chemical bonds, and physical concepts, as in several of their
properties they resemble proper Wannier functions. The mixing of NGWFs to NNHOs is done according to
the procedure by Foster and Weinhold <sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup>.
For this calculation we will use the PBE GGA exchange-correlation functional (<code>XC_FUNCTIONAL PBE</code>).</p>
<h3 id="visualisation-ngwf-and-nnho">Visualisation [NGWF and NNHO]<a class="headerlink" href="#visualisation-ngwf-and-nnho" title="Permanent link">¶</a></h3>
<p>Run the calculation to completion with the two inputs (in separate directories),
it should take no more than five minutes for each of them. </p>
<p>Reference outputs are:</p>
<ul>
<li>output 1: <a href="../files/C2SiH6_NGWF.out"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span>C2SiH6_NGWF.out</a></li>
<li>output 2: <a href="../files/C2SiH6_NNHO.out"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span>C2SiH6_NNHO.out</a></li>
</ul>
<p>Examine some of the NGWF and NNHO output files. As an example, below we show plots of the
third function (NGWF or NNHO) of atom 2 (one of the carbons). Try to obtain similar plots.</p>
<figure>
<p><img alt="image-7" class="center" src="../files/T5_C2SiH6_vmd.png" width='100%",'/>
</p>
<figcaption>Fig.6: A particular NGWF of the C2SiH6 molecule. Visualization in VMD.</figcaption>
</figure>
<!-- .. _Figure fig:C2SiH6_vmd:
.. figure:: _static/tutorial_5/T5_C2SiH6_vmd.png
   :alt: A particular NGWF of the C2SiH6 molecule. Visualization in VMD.
   :name: fig:T5_C2SiH6_vmd
   :width: 100.0%
   :align: center
   :target: _static/tutorial_5/T5_CH2SiH6_vmd.png -->
<p>You can observe that initially the function is a p-atomic orbital (as it is initialised by ONETEP).
After the calculation the NGWF is rather distorted but still contains quite a lot of p character.
The NNHO however is a mixture of all the 4 NGWFs of the carbon atom and is optimally pointed
along the C-C bond. You can quantify these observations by comparing the two output files,
<a href="../files/C2SiH6_NGWF.out"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span>C2SiH6_NGWF.out</a> and
<a href="../files/C2SiH6_NNHO.out"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span>C2SiH6_NNHO.out</a>, which contain an <code>NGWF s/p/d/f Character Analysis</code> section
towards the bottom of the file (thanks to the <code>NGWF_ANALYSIS TRUE</code> keyword in the input).
You will see how much the NGWFs differ from the NNHOs. Of course all the other quantities
(energies, Kohn-Sham orbitals, orbital energies, etc.) are independent of whether you use NGWFs or NNHOs.
Check this by completing the table below.</p>
<figure>
<p><img alt="image-8" class="center" src="../files/T5_C2SiH6_table.png" width='90%",'/>
</p>
<figcaption>Table.2: Fill this table with the data found in the calculation output.</figcaption>
</figure>
<!-- .. _Figure fig:C2SiH6_table:
.. figure:: _static/tutorial_5/T5_C2SiH6_table.png
   :alt: Fill this table with the data found in the calculation output.
   :name: fig:T5_C2SiH6_table.png
   :width: 90.0%
   :align: center
   :target: _static/tutorial_5/T5_C2SiH6_table.png -->
<p>Finally, examine the atomic population in the output files (we have asked for it using the keyword
<code>POPN_CALCULATE TRUE</code> in the input) and confirm that the charges on each atom are consistent
with their relative electronegativities.</p>
<h2 id="nanostructure">Nanostructure<a class="headerlink" href="#nanostructure" title="Permanent link">¶</a></h2>
<p>Let us now see how to set up and visualize a calculation on a nanostructure whose size is in the
region where conventional cubic scaling codes become very inefficient, while linear-scaling codes
like ONETEP are still at the beginning of their capabilities. We will perform a calculation on
the following "nano-peapod" structure, which consists of a C<sub>70</sub> fullerene
inside a single repeat-unit of a (10,8) carbon nanotube.</p>
<figure>
<p><img alt="image-9" class="center" src="../files/T5_C70_in_10-8.png" width='50%",'/>
</p>
<figcaption>Fig.7: The local potential, and the HOMO and LUMO orbitals of the system under study. Visualization in VMD.</figcaption>
</figure>
<!-- .. _Figure fig:C70_in_10-8:
.. figure:: _static/tutorial_5/T5_C70_in_10-8.png
   :alt: The local potential, and the HOMO and LUMO orbitals of the system under study. Visualization in VMD.
   :name: fig:T5_C70_in_10-8
   :width: 50.0%
   :align: center
   :target: _static/tutorial_5/T5_C70_in_10-8.png -->
<h3 id="prepreation_2">Prepreation<a class="headerlink" href="#prepreation_2" title="Permanent link">¶</a></h3>
<p>The (10,8) is a chiral nanotube with
488 atoms in each repeat-unit, so the peapod input consists of 558 atoms, with no symmetry,
in a unit cell of 20.0 x 20.0 x 33.27 (angstroem), which is equivalent to 37.795 x 37.795 x 62.874 (Bohr).</p>
<p>The ONETEP input can be downloaded:</p>
<ul>
<li>Input: <a href="../files/C70_in_10-8.dat"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span>C70_in_10-8.dat</a>. </li>
</ul>
<p>Note that in this input fiel, we impose a density kernel
cut-off of 30.0 Bohr (<code>KERNEL_CUTOFF 30.0 Bohr</code>) in order to achieve linear-scaling behaviour.</p>
<p>This calculation is best run on a parallel computer, but you can run it on a desktop machine
where it should complete in about two-three hours. It took just under 8 minutes when run on
5 nodes (360 CPU cores) in 2023. If you do not want
to wait or do not have the sufficient resources, here's the reference output:
<a href="../files/C70_in_10-8.out"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span>C70_in_10-8.out</a>.</p>
<h3 id="visualisation">Visualisation<a class="headerlink" href="#visualisation" title="Permanent link">¶</a></h3>
<p>Let us start by examining the output file. At the beginning of the calculation the <em>filling</em>
(the opposite of sparsity) of various matrices is reported. You will notice that the density
kernel is not 100% full as a consequence of the cut-off that is imposed in the input.
Information about the psinc grid sizes is also provided, including the actual plane-wave cut-off
to which they correspond and the size of the FFT box. The calculation converges in 7 NGWF iterations,
which is the point where the NGWF gradient threshold set in the input (<code>NGWF_THRESHOLD_ORIG 0.00003</code>)
has been satisfied. Normally you'd likely use a tighter threshold for extra accuracy (the default
is <code>2E-6</code>).</p>
<p>As before, a range of properties are calculated (<code>DO_PROPERTIES T</code>). As an example,
you can examine the total potential (the sum of ionic, Hartree and exchange-correlation potentials)
which is outputted to the file <code>C70_in_10-8_PROP_potential.cube</code>. We do not provide this file
here due its size. A contour plot on a plane containing the nanotube axis of the
potential will look similar to what you see below, which is compatible with the chiral
nature of the nanotube and reveals also the asymmetric way in which the oblong C<sub>70</sub> is
is located inside it.</p>
<figure>
<p><img alt="image-10" class="center" src="../files/T5_C70_in_10-8_vmd.png" width='40%",'/>
</p>
<figcaption>Fig.8: The local potential of the system under study. Visualization in VMD.</figcaption>
</figure>
<!-- .. _Figure fig:C70_in_10-8_vmd:
.. figure:: _static/tutorial_5/T5_C70_in_10-8_vmd.png
   :alt: The local potential of the system under study. Visualization in VMD.
   :name: fig:T5_C70_in_10-8_vmd
   :width: 50.0%
   :align: center
   :target: _static/tutorial_5/T5_C70_in_10-8_vmd.png -->
<p>Red regions correspond to large and positive values of the potential
(standard electrostatic conventions) and reveal the location of nuclei, whose distance from
the plane varies along the axis of the tube, as a result of the chirality. You can go on and
explore other properties of the nano-peapod from the <a href="../files/C70_in_10-8.out"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span>C70_in_10-8.out</a>
file and the other output files that were produced by the properties calculation.</p>
<p>If you are in an ambitious mood, try creating a fancy plot showing the structure of the
nano-peapod system with its HOMO and LUMO orbitals and a contour plot of the potential, similar
to the one below.</p>
<figure>
<p><img alt="image-11" class="center" src="../files/T5_C70_in_10-8_vmd2.png" width='50%",'/>
</p>
<figcaption>Fig.9: The local potential, and the HOMO and LUMO orbitals of the system under study. Visualization in VMD.</figcaption>
</figure>
<!-- .. _Figure fig:C70_in_10-8_vmd2:
.. figure:: _static/tutorial_5/T5_C70_in_10-8_vmd2.png
   :alt: The local potential, and the HOMO and LUMO orbitals of the system under study. Visualization in VMD.
   :name: fig:T5_C70_in_10-8_vmd2
   :width: 80.0%
   :align: center
   :target: _static/tutorial_5/T5_C70_in_10-8_vmd2.png -->
<p>This concludes tutorial 5.</p>

<div class="footnote">
<hr/>
<ol>
<li id="fn:1">
<p>VMD (Visual Molecular Dynamics) is a free of charge visualization package
   available from https://www.ks.uiuc.edu/Research/vmd <a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn:2">
<p>The colouring is described here: https://en.wikipedia.org/wiki/CPK_coloring. <a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
<li id="fn:3">
<p>J. P. Foster and F. Weinhold, <em>J. Am. Chem. Soc.</em> <strong>102</strong>, 7211 (1980). <a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">↩</a></p>
</li>
</ol>
</div>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 2024 ONETEP Collective
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.c011b7c0.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../../assets/javascripts/bundle.7389ff0e.min.js"></script>
<script src="../../../javascripts/mathjax.js"></script>
<script src="../../../javascripts/mkdocs_exporter.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
<script src="../../../javascripts/katex.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
</body>
</html>