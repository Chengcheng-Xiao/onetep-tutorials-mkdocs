<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Tutorials for ONTEP." name="description"/>
<meta content="ONETEP collective" name="author"/>
<link href="../../.." rel="prev"/>
<link href="../../tutorial_4/tutorial/" rel="next"/>
<link href="../../../assets/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.5.3, mkdocs-material-9.5.4" name="generator"/>
<title>Tutorial 1 - ONETEP Tutorials</title>
<link href="../../../assets/stylesheets/main.50c56a3b.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link href="../../../stylesheets/extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="light" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#tutorial-1-simple-onetep-calculations">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="ONETEP Tutorials" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="ONETEP Tutorials">
<img alt="logo" src="../../../assets/onetep-logo.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            ONETEP Tutorials
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Tutorial 1
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="light" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="dark" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"></path></svg>
</label>
</form>
<script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/Chengcheng-Xiao/onetep-tutorials-mkdocs" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</div>
<div class="md-source__repository">
    Chengcheng-Xiao/onetep-tutorials-mkdocs
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="ONETEP Tutorials" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="ONETEP Tutorials">
<img alt="logo" src="../../../assets/onetep-logo.svg"/>
</a>
    ONETEP Tutorials
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/Chengcheng-Xiao/onetep-tutorials-mkdocs" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</div>
<div class="md-source__repository">
    Chengcheng-Xiao/onetep-tutorials-mkdocs
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Tutorials
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Tutorial 1
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Tutorial 1
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#input-files">
<span class="md-ellipsis">
      Input files
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setting-up-the-input-file">
<span class="md-ellipsis">
      Setting up the Input File
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#running-the-job">
<span class="md-ellipsis">
      Running the Job
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#convergence">
<span class="md-ellipsis">
      Convergence
    </span>
</a>
<nav aria-label="Convergence" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#cutoff-energy">
<span class="md-ellipsis">
      Cutoff Energy
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ngwf-radius">
<span class="md-ellipsis">
      NGWF radius
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#kernel-cutoff">
<span class="md-ellipsis">
      Kernel Cutoff
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_4/tutorial/">
<span class="md-ellipsis">
    Tutorial 4
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_5/tutorial/">
<span class="md-ellipsis">
    Tutorial 5
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_6/tutorial/">
<span class="md-ellipsis">
    Tutorial 6
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_8/tutorial/">
<span class="md-ellipsis">
    Tutorial 8
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_9/tutorial/">
<span class="md-ellipsis">
    Tutorial 9
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_10/tutorial/">
<span class="md-ellipsis">
    Tutorial 10
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_11/tutorial/">
<span class="md-ellipsis">
    Tutorial 11
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_12/tutorial/">
<span class="md-ellipsis">
    Tutorial 12
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_13/tutorial/">
<span class="md-ellipsis">
    Tutorial 13
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_14/tutorial/">
<span class="md-ellipsis">
    Tutorial 14
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#input-files">
<span class="md-ellipsis">
      Input files
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setting-up-the-input-file">
<span class="md-ellipsis">
      Setting up the Input File
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#running-the-job">
<span class="md-ellipsis">
      Running the Job
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#convergence">
<span class="md-ellipsis">
      Convergence
    </span>
</a>
<nav aria-label="Convergence" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#cutoff-energy">
<span class="md-ellipsis">
      Cutoff Energy
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ngwf-radius">
<span class="md-ellipsis">
      NGWF radius
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#kernel-cutoff">
<span class="md-ellipsis">
      Kernel Cutoff
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset"><a class="md-content__button md-icon" download="Tutorial 1.pdf" href="index.pdf" title="Download as PDF"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14 2 6 6v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8m4 18V9h-5V4H6v16h12m-6-1-4-4h2.5v-3h3v3H16l-4 4Z"></path></svg></a>

<h1 id="tutorial-1-simple-onetep-calculations">Tutorial 1: Simple ONETEP Calculations<a class="headerlink" href="#tutorial-1-simple-onetep-calculations" title="Permanent link">¶</a></h1>
<p><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h11a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2Zm-.5-2a.5.5 0 0 0 .5.5h11a.5.5 0 0 0 .5-.5V4a.5.5 0 0 0-.5-.5H10a.5.5 0 0 0-.5.5ZM6.17 4.165a.75.75 0 0 1-.335 1.006c-.228.114-.295.177-.315.201a.035.035 0 0 0-.008.016.423.423 0 0 0-.012.112v13c0 .07.008.102.012.112a.03.03 0 0 0 .008.016c.02.024.087.087.315.201a.749.749 0 1 1-.67 1.342c-.272-.136-.58-.315-.81-.598C4.1 19.259 4 18.893 4 18.5v-13c0-.393.1-.759.355-1.073.23-.283.538-.462.81-.598a.75.75 0 0 1 1.006.336ZM2.15 5.624a.75.75 0 0 1-.274 1.025c-.15.087-.257.17-.32.245C1.5 6.96 1.5 6.99 1.5 7v10c0 .01 0 .04.056.106.063.074.17.158.32.245a.75.75 0 0 1-.752 1.298C.73 18.421 0 17.907 0 17V7c0-.907.73-1.42 1.124-1.65a.75.75 0 0 1 1.025.274Z"></path></svg></span> Version: all versions
<span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c-.34.34-.67.67-.68 1-.03.32.31.65.63.96.48.5.95.95.93 1.44-.02.49-.53 1-1.04 1.5l-4.13 4.14L15 14.66l4.25-4.24-.96-.96-1.42 1.41-3.75-3.75 3.84-3.83c.39-.39 1.04-.39 1.41 0l2.34 2.34c.39.37.39 1.02 0 1.41M3 17.25l9.56-9.57 3.75 3.75L6.75 21H3v-3.75Z"></path></svg></span> <a href="mailto:N.D.M.Hine@warwick.ac.uk">Nicholas D.M. Hine</a>;
<a href="mailto:c.skylaris@soton.ac.uk">Chris-Kriton Skylaris</a>
<!-- · :octicons-tag-16: Post-processing | DFT -->
</p>
<h2 id="input-files">Input files<a class="headerlink" href="#input-files" title="Permanent link">¶</a></h2>
<p>Setting up a ONETEP job involves creating a main input file with the
suffix <code>.dat</code> (e.g., <code>your_system.dat</code>) which contains all the required information to
describe both the system and the parameters of the job.</p>
<p>This requires the user to provide input in the form of keywords and blocks.
Keywords are written in the form:
</p><div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1">keyword: value [unit]
</span></code></pre></div></td></tr></table></div>
For example, to specify that the task we wish the code to perform is a
Single-Point energy calculation, we would add:
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1">task : SinglePoint
</span></code></pre></div></td></tr></table></div>
to our input file.
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Capitalisation in the input file is irrelevant.</p>
</div>
<p>If we wish to specify a cutoff energy of 500 eV for our standard grid,
we would add:
</p><div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1">cutoff_energy : 500.0 eV
</span></code></pre></div></td></tr></table></div>
The value in eV’s will be converted internally to atomic units (Eh in
this case). If a keyword is not specified in the input file, it is given
a default value which is intended to work across a broad range of
systems. A full list of keywords and blocks, giving their meaning,
syntax and default values, can be found on the <a href="https://onetep.org/resources/keyword-database/"><img alt="🔗" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f517.svg" title=":link:"/> ONETEP keyowrd database</a>.
<p>Blocks are used to define the values of input parameters which need to
contain multiple records, such as the definition of the unit cell.
They take the form:
</p><div class="language-fortran highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><span class="p">%</span><span class="k">block </span><span class="n">blockname</span>
</span><span id="__span-3-2"><span class="n">a1</span><span class="w"> </span><span class="n">a2</span><span class="w"> </span><span class="n">a3</span>
</span><span id="__span-3-3"><span class="n">b1</span><span class="w"> </span><span class="n">b2</span><span class="w"> </span><span class="n">b3</span>
</span><span id="__span-3-4"><span class="err">…</span>
</span><span id="__span-3-5"><span class="p">%</span><span class="k">endblock </span><span class="n">blockname</span>
</span></code></pre></div></td></tr></table></div>
Most blocks tend <strong>not</strong> to have a meaningful default value, and must be
specified if the related functionality is to be used. Comments can be
added to input files using the <code>#</code>or<code>!</code> characters. Anything after
these characters on a given line will be ignored.
<h2 id="setting-up-the-input-file">Setting up the Input File<a class="headerlink" href="#setting-up-the-input-file" title="Permanent link">¶</a></h2>
<p>We will start by running a simple job on a silane molecule
SiH<span class="arithmatex">\(_4\)</span>. Create a working directory in which to run ONETEP:
</p><div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1">&gt;<span class="w"> </span>mkdir<span class="w"> </span>silane
</span><span id="__span-4-2">&gt;<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>silane
</span></code></pre></div></td></tr></table></div>
Create a new input file called silane.dat in your favourite text
editor e.g.
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1">&gt;<span class="w"> </span>vi<span class="w"> </span>silane.dat
</span></code></pre></div></td></tr></table></div>
You might like to put a comment at the top explaining what this input
file is for e.g.
<div class="language-fortran highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><span class="c">! Simple ONETEP input file for a silane molecule</span>
</span></code></pre></div></td></tr></table></div>
<p>The first thing is to specify the simulation cell.
The simplest choice is a cubic box with sides of about 40.0 Bohr.
Enter the 3-component cell vectors, one per line, between the <code>%block
lattice_cart</code> and <code>%endblock lattice_cart</code> keywords.</p>
<div class="language-fortran highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><span class="p">%</span><span class="k">block </span><span class="n">lattice_cart</span>
</span><span id="__span-7-2"><span class="mi">4</span><span class="mf">0.0</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mf">0.0</span>
</span><span id="__span-7-3"><span class="mf">0.0</span><span class="w"> </span><span class="mi">4</span><span class="mf">0.0</span><span class="w"> </span><span class="mf">0.0</span>
</span><span id="__span-7-4"><span class="mf">0.0</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="mi">4</span><span class="mf">0.0</span>
</span><span id="__span-7-5"><span class="p">%</span><span class="k">endblock </span><span class="n">lattice_cart</span>
</span></code></pre></div></td></tr></table></div>
<p>Second, the atomic species need to be specified, in this case silicon
and hydrogen.
This information needs to be provided between <code>%block species</code> and
<code>%endblock species</code> keywords.
In this block, we need to specify five pieces of information per
species, separated by spaces (click on the <code>+</code> button to see the meaning
of each piece):</p>
<div class="language-fortran highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1"><span class="p">%</span><span class="k">block </span><span class="n">species</span>
</span><span id="__span-8-2"><span class="c">!(1) (2) (3) (4) (5)</span>
</span><span id="__span-8-3"><span class="w">  </span><span class="n">Si</span><span class="w">  </span><span class="n">Si</span><span class="w">  </span><span class="mi">14</span><span class="w">  </span><span class="mi">4</span><span class="w">   </span><span class="mf">6.0</span>
</span><span id="__span-8-4"><span class="w">  </span><span class="n">H</span><span class="w">   </span><span class="n">H</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">   </span><span class="mf">6.0</span>
</span><span id="__span-8-5"><span class="p">%</span><span class="k">endblock </span><span class="n">species</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li><strong>Your symbol</strong> for the atomic species
    (this can be the same as the element symbol)</li>
<li>The element symbol itself</li>
<li>The atomic number Z</li>
<li>The number of NGWFs per atom</li>
<li>The NGWF radius.</li>
</ol>
<p>The number of NGWFs required can usually be judged from the symmetry of
the atomic orbitals involved: In this case four for silicon and one for
hydrogen will be adequate <em>(can you think why?)</em>.
For this molecule, 6.0 Bohr should be a reasonable starting point for
the NGWF radii.</p>
<p>Each atomic species in our calculation needs a pseudopotential file.
The pseudopotential files are specified between <code>%block species_pot</code> and
<code>%endblock species_pot</code> keywords. You can use the <code>hydrogen.recpot</code> and
<code>silicon.recpot</code> files from the ONETEP pseudopotentials <code>pseudo</code>
directory. Copy them to your working directory now (or make a symbolic
link using <code>ln -s source destination</code>).</p>
<div class="language-fortran highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1"><span class="p">%</span><span class="k">block </span><span class="n">species_pot</span>
</span><span id="__span-9-2"><span class="n">Si</span><span class="w">    </span><span class="s2">"PATH/TO/pseudo/silicon.recpot"</span>
</span><span id="__span-9-3"><span class="n">H</span><span class="w">     </span><span class="s2">"PATH/TO/pseudo/hydrogen.recpot"</span><span class="w"> </span><span class="c">!(1)!</span>
</span><span id="__span-9-4"><span class="p">%</span><span class="k">endblock </span><span class="n">species_pot</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li>Remember to change <code>PATH/TO</code> to the correct path to your potential files.</li>
</ol>
<p>Next, we need to specify the atomic positions, between <code>%block
positions_abs</code> and <code>%endblock positions_abs</code> keywords.
There is one line per atom. Remember to use your symbol for the atomic
species as defined in the species block. The coordinates are assumed
to be given in Bohr unless specified otherwise. While it is not
requirement in ONETEP that all the atoms should lie within the
simulation cell, it is best (for visualisation purposes) to start by
placing the silicon atom at the centre of the cell. For SiH<sub>4</sub>, we can write:
</p><div class="language-fortran highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1"><span class="p">%</span><span class="k">block </span><span class="n">positions_abs</span>
</span><span id="__span-10-2"><span class="n">Si</span><span class="w"> </span><span class="mi">2</span><span class="mf">0.0000</span><span class="w"> </span><span class="mi">2</span><span class="mf">0.0000</span><span class="w"> </span><span class="mi">2</span><span class="mf">0.0000</span>
</span><span id="__span-10-3"><span class="n">H</span><span class="w">  </span><span class="mi">2</span><span class="mf">2.2535</span><span class="w"> </span><span class="mi">2</span><span class="mf">1.5935</span><span class="w"> </span><span class="mi">2</span><span class="mf">0.0000</span>
</span><span id="__span-10-4"><span class="n">H</span><span class="w">  </span><span class="mi">1</span><span class="mf">7.7465</span><span class="w"> </span><span class="mi">2</span><span class="mf">1.5935</span><span class="w"> </span><span class="mi">2</span><span class="mf">0.0000</span>
</span><span id="__span-10-5"><span class="n">H</span><span class="w">  </span><span class="mi">2</span><span class="mf">0.0000</span><span class="w"> </span><span class="mi">1</span><span class="mf">8.4065</span><span class="w"> </span><span class="mi">2</span><span class="mf">2.2535</span>
</span><span id="__span-10-6"><span class="n">H</span><span class="w">  </span><span class="mi">2</span><span class="mf">0.0000</span><span class="w"> </span><span class="mi">1</span><span class="mf">8.4065</span><span class="w"> </span><span class="mi">1</span><span class="mf">7.7465</span>
</span><span id="__span-10-7"><span class="p">%</span><span class="k">endblock </span><span class="n">positions_abs</span>
</span></code></pre></div></td></tr></table></div>
<!-- The Si-H bond length is about 2.76 Bohr and silane is a tetrahedral
molecule. The simplest way to work out the coordinates is to note that
tetrahedral bonds can be chosen to lie along unit vectors
(a, b, 0), (−a, b, 0), (0, −b, a) and (0, −b, −a) where a = p 2/3 and
b = p 1/3.
For example, the vector for the first Si-H bond is (2.2535, 1.5935,
0.0000) Bohr. Add these offsets to the position of your silicon atom
to create the SiH$_4$ molecule. -->
<figure>
<p><img _="," alt="image-1" class="center" src="../files/SiH4.png" width="40%"/>
</p>
<figcaption>Fig.1: structure of a SiH<sub>4</sub> molecule.</figcaption>
</figure>
<!-- ------------------------------------------------------------------------------- -->
<!-- This section contain html5 codes for interactive visualization of crystal -->
<!-- structures and molecular geometries. -->
<!-- ------------------------------------------------------------------------------- -->
<!-- -->
<!-- [> loading local scripts <] -->
<!-- <script type="text/javascript" src="../../../javascripts/jmol/jsmol/JSmol.min.js"></script> -->
<!-- <script type="text/javascript" src="../../../javascripts/jmol/jsmol/js/Jmol2.js"></script> -->
<!-- <script type="text/javascript"> jmolInitialize("../../../javascripts/jmol/jsmol");</script> -->
<!-- [> loading external scripts (only works with public repo) <] -->
<!-- [> <script src="https://chemapps.stolaf.edu/jmol/jsmol/JSmol.min.js"></script> <] -->
<!-- [> <script src="https://chemapps.stolaf.edu/jmol/jsmol/js/Jmol2.js"></script> <] -->
<!-- [> <script> jmolInitialize("https://chemapps.stolaf.edu/jmol/jsmol/jsmol");</script> <] -->
<!-- -->
<!-- [> create div and autoadjust hight and width <] -->
<!-- <div id="vis" style="z-index:0; position:relative; width:80%; height:302px; margin:0 auto; float:center; overflow:auto; border:2px solid rgba(172, 174, 176,5);border-radius: 10px; align: center"> -->
<!-- <script type="text/javascript"> -->
<!-- var offsetHeight = document.getElementById('vis').offsetHeight; -->
<!-- var offsetWidth  = document.getElementById('vis').offsetWidth; -->
<!-- jmolApplet([offsetWidth-2,offsetHeight-2], "load ../files/SiH4.vasp {1 1 1}; set frank off; set displayCellParameters off; set background white") -->
<!-- </script> -->
<!-- </div> -->
<!-- -->
<!-- ------------------------------------------------------------------------------- -->
<!-- -->
<!-- [> using remote JSmol <] -->
<!-- [> <div id="vis" style="z-index:0; position:relative; width:80%; height:302px; margin:0 auto; float:center; overflow:auto; border:2px solid rgba(172, 174, 176,5);border-radius: 10px; align: center"> <] -->
<!-- [> <script> <] -->
<!-- [> var offsetHeight = document.getElementById('vis').offsetHeight; <] -->
<!-- [> var offsetWidth  = document.getElementById('vis').offsetWidth; <] -->
<!-- [> var Info = { <] -->
<!-- [> height: offsetHeight-2, <] -->
<!-- [> width: offsetWidth-2, <] -->
<!-- [> isSigned: false, <] -->
<!-- [> j2sPath: "https://chemapps.stolaf.edu/jmol/jsmol/j2s", <] -->
<!-- [> serverURL: "https://chemapps.stolaf.edu/jmol/jsmol/php/jsmol.php", <] -->
<!-- [> use: "HTML5"}; <] -->
<!-- [> jmolApplet = Jmol.getApplet("jmol",Info) <] -->
<!-- [> Jmol.script(jmolApplet, <] -->
<!-- [>   "load ../files/SiH4.vasp {1 1 1}; \ <] -->
<!-- [>   set frank off; \ <] -->
<!-- [>   set displayCellParameters off; \ <] -->
<!-- [>   set background white; \ <] -->
<!-- [>   set platformSpeed = 2","0") <] -->
<!-- [> </script> <] -->
<!-- [> </div> <] -->
<!-- ------------------------------------------------------------------------------- -->
<p>The last essential parameter to specify is the kinetic energy cutoff
parameter for the PSINC basis set. A reasonable value to start with is
300 eV. Use the cutoff_energy keyword and remember to specify the
energy unit as well as the value.
</p><div class="language-FORTRAN highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-11-1"><span class="n">cutoff_energy</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="w"> </span><span class="n">eV</span>
</span></code></pre></div></td></tr></table></div>
<h2 id="running-the-job">Running the Job<a class="headerlink" href="#running-the-job" title="Permanent link">¶</a></h2>
<p>Assuming the executable of ONETEP is located at <code>~/ONETEP/bin/onetep</code>, we can now run our job with:
</p><div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1">~/ONETEP/bin/onetep<span class="w"> </span>silane<span class="w"> </span><span class="p">|</span><span class="w"> </span>tee<span class="w"> </span>silane.out
</span></code></pre></div></td></tr></table></div>
Examine the output: if you have followed these instructions it should
converge very quickly (8 iterations) to a total energy of around
-6.1897 Eh.
<h2 id="convergence">Convergence<a class="headerlink" href="#convergence" title="Permanent link">¶</a></h2>
<p>Just as in any form of traditional DFT, we must ensure that our
calculation results are converged with respect to the size of the
basis. In ONETEP, convergence with basis size is controlled by a small
number of parameters, with respect to which the total energy is
variational. In this context, that means the total energy at a given
value of the parameter will be an upper bound to the true, converged
total energy, and increasing the parameter will monotonically decrease
the total energy, which asymptotically tends to its converged value.</p>
<h3 id="cutoff-energy">Cutoff Energy<a class="headerlink" href="#cutoff-energy" title="Permanent link">¶</a></h3>
<p>The first parameter will be familiar to anyone who has carried out
plane-wave DFT calculations: <strong>the cutoff energy</strong>. This specifies the
kinetic energy of the maximum G-vector of the reciprocal-space grid,
and therefore the spacing of the real-space grid. With a 40 Bohr cell
and a 300eV cutoff, ONETEP will have chosen a 48<span class="arithmatex">\(\times\)</span>48<span class="arithmatex">\(\times\)</span>48 grid, hence
a grid spacing of 0.833 Bohr. This may be too coarse: move your old
output file to a new name (e.g., <code>SiH4.out_Ec300</code>) and try changing the
cutoff energy to 500eV, then re-run the job script. You may wish to
add <code>output_detail: VERBOSE</code> to your input file, to see exactly what
grids are being used at each cutoff.</p>
<p>Comparing the two outputs, you should see that the total energy has
decreased by around 0.03Eh (nearly 1eV, or 0.2 eV/atom). This suggests
300 eV was too low initially. Try increasing the cutoff in steps of
100 eV (You may wish to automate this, by having a loop in your job
script in which the input file is updated and the job run for each
update, if you are sufficiently familiar with bash scripting)</p>
<p>Plot the total energy (<span class="arithmatex">\(E_T\)</span>) as a function of cutoff energy. You should
see a monotonic decrease in ET as a function of <span class="arithmatex">\(E_{cut}\)</span>: try to evaluate
at what value you think the total energy is converged to about
0.1 eV/atom of its asymptotic limit. Note that the calculation time
increases rapidly with cutoff energy, because the number of grid
points in each FFTbox is growing rapidly with cutoff energy, and thus
each FFT takes longer, so do not try going beyond around 1200 eV.</p>
<p>In few cases in reality do we require strict convergence of the total
energy. It is more usual that we require convergence of some
measurable quantity such as a binding energy, which is based on energy
differences.
In that case, we do not require the total energy to be converged, only
the difference between total energies of very similar systems. This
may converge much faster than the total energy itself, presuming the
same species are present in both systems. Always consider what it is
that you need converging before you start running enormous
calculations!</p>
<h3 id="ngwf-radius">NGWF radius<a class="headerlink" href="#ngwf-radius" title="Permanent link">¶</a></h3>
<p>Next, we will investigate convergence with respect to the NGWF radius.
Pick a value of cutoff energy for which you can perform reasonably
fast calculations (say, 500.0 eV) and try increasing the NGWF radius
from 6.0 to 10.0 in 1.0 Bohr steps. Plot the total energy against NGWF
radius. Again, you should see a monotonic decrease. Note that above
6.0 Bohr the FFT box is as large as the simulation cell, in a larger
cell this would keep growing, and the calculation time would increase
rapidly. Also, you should notice that the number of NGWF Conjugate
Gradients iterations grows with the size of the localisation region,
this is natural since with larger spheres there are more NGWF
coefficients to simultaneously optimise.
You may also wish to try converging with respect to the number of
NGWFs per atom (eg try 9 NGWFs on the Silicon). In some systems,
notably crystalline solids, this can be crucial to achieving good
convergence of the NGWFs themselves.</p>
<div class="admonition info">
<p class="admonition-title">TODO</p>
<ul>
<li>add example script to do this.</li>
<li>add plots.</li>
</ul>
</div>
<h3 id="kernel-cutoff">Kernel Cutoff<a class="headerlink" href="#kernel-cutoff" title="Permanent link">¶</a></h3>
<p>This SiH<span class="arithmatex">\(_4\)</span> system is too small to investigate convergence with
respect to the cutoff of the density kernel. In larger systems
truncation of the density kernel can be a good way to speed up the
calculation. Indeed, asymptotically it is only by truncating the kernel
that true 'linear-scaling' behaviour of the computational effort will
be observed.</p>
<p>The kernel cutoff is controlled by the kernel_cutoff keyword. This
defaults to 1000 Bohr (i.e. effectively infinite). Density kernel
truncation should be used with a degree of caution: generally speaking,
one would want to be able to run a full calculation for a fairly large
system first, with an infinite cutoff, to establish a known baseline.
Then, try decreasing the kernel cutoff from that point and see what the
effect is on the total energy, on the level of NGWF convergence (as
measured by the NGWF RMS gradient), and on the computation time. If
significant time savings can be achieved without trading in too much
accuracy, it may be worthwhile to bring down the cutoff for all similar
calculations. Proceed with care, though as calculations with a truncated
kernel tend to converge in a less stable manner.</p>
<div class="admonition info">
<p class="admonition-title">TODO</p>
<ul>
<li>add plots to illustrate the density matrix and the cutoff.</li>
<li>add example script to do this.</li>
<li>add plots for eonvergence.</li>
</ul>
</div>
<!-- # Crystalline Silicon

You may wish to try out also a calculation on a periodic solid.
As it is fairly well-behaved but illustrates some interesting
concepts, let’s try crystalline silicon, in the diamond (f.c.c.)
structure. We will build a 2 × 2 × 2 version of the 8-atom
simple-cubic unit cell.
Copy your SiH$_4$ input to a new file (eg Si64.dat) in a new
directory (eg SILICON) and remove the references to hydrogen from the
species and species_pot blocks. Copy silicon.recpot to this directory
as well. In the new input file, set the NGWF radius to 7.0 Bohr, the
number of NGWFs per atom to 4, and the cutoff energy to 600eV. Edit
the cell side length so that it is 2× the lattice parameter of
crystalline silicon in the LDA (around 10.1667 Bohr). For reasons that
will become clear if you read the last section of this tutorial, on
Common Problems, also set ngwf_cg_max_step: 8.0 to prevent the CG line
step being capped unnecessarily and maxit_ngwf_cg: 30 to terminate the
NGWF CG after 30 iterations (in case it’s not converging).
Typing out the positions would be rather time-consuming and
error-prone with 64 atoms in the cell, so use your favourite
scripting/programming language (bash, awk, python, perl, etc would all
be suitable or even C or FORTRAN) to write a list of the positions.
You will need to repeat the basis (atoms at (0, 0, 0) and
(1/4,1/4,1/4)a ) at each of the positions of the f.c.c. lattice: (0,
0, 0), (1/2,1/2,0), (0,1/2,1/2), and (1/2, 0, 1/2,). Copy the result
into your positions_abs block. An example input file for this job can
be found on the tutorial web page.
The calculation should take around a few minutes. Feel free to stop it
as soon as you see what is happening, since you will find that the
calculation fails to converge: the RMS gradient remains stuck above
the threshold for convergence. Likewise, the total energy will not
converge to a fixed value. Make a copy of your output and modify the
NGWF radius in the input file to 8.0 Bohr and the number of NGWFs per
Si atom to 9. This introduces NGWFs with d-like symmetry rather than
just s and p, allowing much more variational freedom. You should now
find the calculation converges nicely, but will take rather longer to
run.

Now try activating write_forces: T to calculate the forces on each
atom. All the forces should be small: in principle they are
constrained by the symmetry of the crystal to be exactly zero.
However, you will see that they are not exactly zero because the
symmetry of the system is broken by the psinc grid, which is not
necessarily commensurate with the unit cell. However, in this small
cell, it will not be possible to fix this as the number of points
across the FFT box must be odd, and in a small cell the simulation
cell and the FFT box coincide, so the number of points across the
simulation cell must also be odd.

Adjust your script to write a 5 × 5 × 5 supercell of the crystal (1000
atoms). Reduce the kernel cutoff to 25 Bohr with kernel_cutoff: 25.0 and
set the code to perform 1 NGWF iteration only maxit_ngwf_cg: 1
(otherwise the calculation would take longer to run, you can try this if
you have time). To restore the symmetry, adjust the psinc_spacing value
to be a divisor of the supercell length such that an exact number of
grid points spans each unit cell of the crystal (pick a value which
gives an effective cutoff energy close to 600.0 eV so as not to increase
the run time too much) and and set off the 1000 atom job. This should
not take too long on 32 cores.

Beyond around 500 atoms, the calculation should be into the so-called
\`linear-scaling’ regime, so the 8000 atom calculation should only take
a little over 8 times the 1000 atom calculation. This is rather better
than the nearly 512 times longer it would take with traditional
cubic-scaling DFT!

## Diagnosing Common Failures

With badly-chosen input settings, even fairly standard calculations in
ONETEP will not converge, or may even converge to the wrong result.
Fortunately, many of these problems are easy to fix with a bit of
experience. In general, it is advisable to run with full output
verbosity (output_detail: VERBOSE) the first few times you run a new
kind of system, and to be on the lookout for any warnings or garbage
numbers in the output (eg \***\*‘s in place of what should be real
numbers). Remember that for the energy to be accurate, we must have
simultaneous convergence of both the density kernel and the NGWFs. If
either of these are not converging well by the end of the calculation,
there may be a problem. In this section, we will briefly examine some
reasons behind common types of convergence failure, and what to do to
eliminate those failures and perform accurate simulations.

- Problem: Repeated ’safe’ steps (of 0.150 or 0.100) during NGWF
Conjugate Gradients optimisation, leading to poor or no convergence.
This often means that the step length cap for NGWF CG is too short.
**Solution:** increase ngwf_cg_max_step, eg to 8.0.

- Problem: Repeated ‘safe’ steps (of 0.150 or 0.100) during LNV
Conjugate Gradients optimisation, leading to poor or no convergence.
This often means that the step length cap for LNV CG is too short.
**Solution:** increase lnv_cg_max_step, eg to 8.0.

- Problem: Occupancies \`break’ during LNV optimisation of kernel.
Examine the output with output_detail: VERBOSE and look at the occupancy
error and occupancy bounds during the “Penalty functional idempotency
correction” section of each LNV step. Check for occupancies outside the
stable range (approx -0.3:1.3) or RMS occupancy errors not decreasing
(particularly if no kernel truncation is applied).
**Solution:** Activate
LNV line step checking with lnv_check_trial_steps: T. This checks that
the kernel is still stable after the proposed line step is taken.

- Problem: Occupancies are \`broken’ from start of calculation. Symptoms
as above. Palser Manolopoulos may be unstable due to degeneracy or
near-degeneracy at the Fermi level. Check the output of Palser
Manolopoulos for warnings.
**Solution:** If there is an initial degeneracy
at the Fermi level, an O(N3 ) diagonalisation may be required to get a
good starting kernel. Set maxit_palser_mano : -1.

- Problem: RMS Commutator (HKS-SKH) of kernel and Hamiltonian stagnates
(stops going down with each iteration) during LNV optimisation. This is
a sign that the current set of NGWFs is not able to represent a density
matrix that both reproduces the electron density that generated the
Hamiltonian while simultaneously describing the occupied eigenstates of
that Hamiltonian. If this problem does not start to go away after a few
steps of NGWF optimisation, a better or larger initial set of NGWFs may
be required.
**Solutions:** Increase number of NGWFs per atom, increase
radius of NGWFs, improve initial guess for NGWFs.

- **Problem**: RMS NGWF gradient stagnates (stops going down) during NGWF CG
optimisation, while energy is still going down slowly. This often
suggests that the NGWFs may have expanded away from their centres to
have significant value near the edge of their localisation region, and
thus cannot optimise successfully.

- **Solution:** Increase NGWF radius.
Sometimes increasing the kinetic energy cutoff helps as well. For
smaller systems and initial tests, a useful check on the accuracy of the
final result is to perform a full O(N\ :math:`^3`) diagonalisation at
the end of the calculation, if it is computationally feasible to do so.
To activate this, turn on a properties calculation with do_properties:
T, and then ask for an eigenvalue calculation of the first 100
eigenvalues either side of the Fermi energy, for the kernel and
Hamiltonian matrices, by setting num_eigenvalues: 100. If all is well,
then the occupation eigenvalues should all be close to 0.00000 or
1.00000 (empty or full) and the Hamiltonian eigenvalues should all be
within a sensible range.

One final note if you’re not getting the result you expect – check the
units on your atomic positions! ONETEP expects positions in Bohr if the
units are not specified, so if your positions are in Angstroms, you will
need to add ‘ang’ as the first line of the positions_abs block.

This completes tutorial 1.

Files for this tutorial:

 - :download:`SiH4.dat <_static/tutorial_1/SiH4.dat>`
 - :download:`Si8000.dat <_static/tutorial_1/Si8000.dat>`
 - :download:`Si64.dat <_static/tutorial_1/Si64.dat>`
 - :download:`Si1000.dat <_static/tutorial_1/Si1000.dat>` -->

</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 2024 ONETEP Collective
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.c011b7c0.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../../assets/javascripts/bundle.7389ff0e.min.js"></script>
<script src="../../../javascripts/mathjax.js"></script>
<script src="../../../javascripts/mkdocs_exporter.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
<script src="../../../javascripts/katex.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
</body>
</html>