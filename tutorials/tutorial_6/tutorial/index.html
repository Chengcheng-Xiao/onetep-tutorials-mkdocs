<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Tutorials for ONTEP." name="description"/>
<meta content="ONETEP collective" name="author"/>
<link href="../../tutorial_5/tutorial/" rel="prev"/>
<link href="../../tutorial_8/tutorial/" rel="next"/>
<link href="../../../assets/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.5.3, mkdocs-material-9.5.4" name="generator"/>
<title>Tutorial 6 - ONETEP Tutorials</title>
<link href="../../../assets/stylesheets/main.50c56a3b.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link href="../../../stylesheets/extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="light" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#tutorial-6-time-dependent-dft">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="ONETEP Tutorials" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="ONETEP Tutorials">
<img alt="logo" src="../../../assets/onetep-logo.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            ONETEP Tutorials
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Tutorial 6
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="light" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="dark" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"></path></svg>
</label>
</form>
<script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/Chengcheng-Xiao/onetep-tutorials-mkdocs" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</div>
<div class="md-source__repository">
    Chengcheng-Xiao/onetep-tutorials-mkdocs
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="ONETEP Tutorials" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="ONETEP Tutorials">
<img alt="logo" src="../../../assets/onetep-logo.svg"/>
</a>
    ONETEP Tutorials
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/Chengcheng-Xiao/onetep-tutorials-mkdocs" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</div>
<div class="md-source__repository">
    Chengcheng-Xiao/onetep-tutorials-mkdocs
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Tutorials
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_1/tutorial/">
<span class="md-ellipsis">
    Tutorial 1
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_4/tutorial/">
<span class="md-ellipsis">
    Tutorial 4
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_5/tutorial/">
<span class="md-ellipsis">
    Tutorial 5
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Tutorial 6
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Tutorial 6
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#tddft-in-onetep">
<span class="md-ellipsis">
      TDDFT in ONETEP
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setting-up-a-tddft-calculation-in-onetep">
<span class="md-ellipsis">
      Setting up a TDDFT calculation in ONETEP
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#an-nn-substituted-nanoribbon">
<span class="md-ellipsis">
      An NN-substituted nanoribbon
    </span>
</a>
<nav aria-label="An NN-substituted nanoribbon" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#conduction-optimisation">
<span class="md-ellipsis">
      Conduction optimisation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#tddft-calculation">
<span class="md-ellipsis">
      TDDFT calculation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nitrogen-substitution">
<span class="md-ellipsis">
      Nitrogen substitution
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#additional-tasks">
<span class="md-ellipsis">
      Additional tasks
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#input-files">
<span class="md-ellipsis">
      Input files
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_8/tutorial/">
<span class="md-ellipsis">
    Tutorial 8
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_9/tutorial/">
<span class="md-ellipsis">
    Tutorial 9
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_10/tutorial/">
<span class="md-ellipsis">
    Tutorial 10
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_11/tutorial/">
<span class="md-ellipsis">
    Tutorial 11
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_12/tutorial/">
<span class="md-ellipsis">
    Tutorial 12
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_13/tutorial/">
<span class="md-ellipsis">
    Tutorial 13
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tutorial_14/tutorial/">
<span class="md-ellipsis">
    Tutorial 14
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#tddft-in-onetep">
<span class="md-ellipsis">
      TDDFT in ONETEP
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setting-up-a-tddft-calculation-in-onetep">
<span class="md-ellipsis">
      Setting up a TDDFT calculation in ONETEP
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#an-nn-substituted-nanoribbon">
<span class="md-ellipsis">
      An NN-substituted nanoribbon
    </span>
</a>
<nav aria-label="An NN-substituted nanoribbon" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#conduction-optimisation">
<span class="md-ellipsis">
      Conduction optimisation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#tddft-calculation">
<span class="md-ellipsis">
      TDDFT calculation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nitrogen-substitution">
<span class="md-ellipsis">
      Nitrogen substitution
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#additional-tasks">
<span class="md-ellipsis">
      Additional tasks
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#input-files">
<span class="md-ellipsis">
      Input files
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset"><a class="md-content__button md-icon" download="Tutorial 6.pdf" href="index.pdf" title="Download as PDF"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14 2 6 6v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8m4 18V9h-5V4H6v16h12m-6-1-4-4h2.5v-3h3v3H16l-4 4Z"></path></svg></a>

<h1 id="tutorial-6-time-dependent-dft">Tutorial 6: Time-Dependent DFT<a class="headerlink" href="#tutorial-6-time-dependent-dft" title="Permanent link">¶</a></h1>
<p><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h11a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2Zm-.5-2a.5.5 0 0 0 .5.5h11a.5.5 0 0 0 .5-.5V4a.5.5 0 0 0-.5-.5H10a.5.5 0 0 0-.5.5ZM6.17 4.165a.75.75 0 0 1-.335 1.006c-.228.114-.295.177-.315.201a.035.035 0 0 0-.008.016.423.423 0 0 0-.012.112v13c0 .07.008.102.012.112a.03.03 0 0 0 .008.016c.02.024.087.087.315.201a.749.749 0 1 1-.67 1.342c-.272-.136-.58-.315-.81-.598C4.1 19.259 4 18.893 4 18.5v-13c0-.393.1-.759.355-1.073.23-.283.538-.462.81-.598a.75.75 0 0 1 1.006.336ZM2.15 5.624a.75.75 0 0 1-.274 1.025c-.15.087-.257.17-.32.245C1.5 6.96 1.5 6.99 1.5 7v10c0 .01 0 .04.056.106.063.074.17.158.32.245a.75.75 0 0 1-.752 1.298C.73 18.421 0 17.907 0 17V7c0-.907.73-1.42 1.124-1.65a.75.75 0 0 1 1.025.274Z"></path></svg></span> Version: all versions
<span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c-.34.34-.67.67-.68 1-.03.32.31.65.63.96.48.5.95.95.93 1.44-.02.49-.53 1-1.04 1.5l-4.13 4.14L15 14.66l4.25-4.24-.96-.96-1.42 1.41-3.75-3.75 3.84-3.83c.39-.39 1.04-.39 1.41 0l2.34 2.34c.39.37.39 1.02 0 1.41M3 17.25l9.56-9.57 3.75 3.75L6.75 21H3v-3.75Z"></path></svg></span> <a href="mailto:">Tim Zuehlsdorf</a>;
 <!-- · :octicons-tag-16: Post-processing | DFT -->
</p>
<h2 id="tddft-in-onetep">TDDFT in ONETEP<a class="headerlink" href="#tddft-in-onetep" title="Permanent link">¶</a></h2>
<p>This tutorial aims at showing how to run a simple linear-response TDDFT calculation in ONETEP.
Linear-response TDDFT is the main method of choice when computing optical excitations for
large system sizes. In this formalism, excitation energies are directly obtained as the solutions to
an effective eigenvalue equation. The approach implemented in ONETEP can be made to scale
fully linearly with systems size, allowing for the computation of excitations in systems containing
thousands of atoms.</p>
<p>In linear-response TDDFT, an excitation is expressed through a transition vector that can be
written in the basis of all possible Kohn-Sham transtions from occupied to unoccupied states.
Thus unlike in standard ground state DFT, where a good representation of the occupied KohnSham states is sufficient 
to obtain accurate results, in a TDDFT calculation an equally good
representation of a subset of the unoccupied Kohn-Sham space is vital. Since the ONETEP
support functions are optimised <em>in situ</em> to ideally represent the occupied manifold, they generally
provide a relatively poor description of the unoccupied manifold, making them insufficient for
describing excitations in a linear-response framework. In practice, this problem is removed by
optimising a second set of support functions to ideally span a low energy subset of the conduction
space in a post-processing step after a <code>Singlepoint</code> calculation. Together, the two sets of support
functions form an ideal representation of any given low energy excitation, thus enabling efficient
iand accurate TDDFT calculations in very large systems.</p>
<h2 id="setting-up-a-tddft-calculation-in-onetep">Setting up a TDDFT calculation in ONETEP<a class="headerlink" href="#setting-up-a-tddft-calculation-in-onetep" title="Permanent link">¶</a></h2>
<p>A TDDFT calculation in ONETEP thus proceeds in three separate steps:</p>
<ul>
<li>A standard ground state calculation using <code>Task: Singlepoint</code>. The code will write out <code>.dkn</code> and <code>.tightbox_ngwfs</code> files containing the valence density kernel and the NGWF support functions.</li>
<li>A conduction optimisation using <code>Task: Cond</code>. The code will read in the converged <code>.dkn</code> and <code>.tightbox_ngwfs</code> files from the ground-state optimisation and perform a postprocessing <code>conduction optimisation</code> of some low energy part of the conduction space manifold. It will write out <code>.dkn_cond</code> and <code>.tightbox_ngwfs_cond</code> files containing an effective density kernel for the low energy conduction space, as well as the NGWF support functions for the conduction space.</li>
<li>A TDDFT calculation using <code>Task: Lr_tddft</code>. The code will read in the density kernels and support functions for both the ground state and the conduction space calculations and then calculate the lowest <em>n</em> excitations of the system, where <em>n</em> is determined by the keyword <code>lr_tddft_num_states</code>.</li>
</ul>
<p>In practice, it is possible to string these tasks together using <code>Task: Singlepoint Cond Lr_tddft</code>
in an input file that lists appropriate keywords for all three calculation types. The tasks will be
performed one after another, without the user having to restart the calculation in between.</p>
<h2 id="an-nn-substituted-nanoribbon">An NN-substituted nanoribbon<a class="headerlink" href="#an-nn-substituted-nanoribbon" title="Permanent link">¶</a></h2>
<p>We turn to a simple example of an excited state calculation in a periodic system, namely that of
an infinitely long graphene nanoribbon with two nitrogen substitutions. We will aim to compute
excited states that are associated with the substitution and that are thus relatively localised in
character. In a first step, we aim to build an input file for a pristine graphene nanoribbon in
periodic boundary conditions. A primitive unit cell for the nanoribbon in question can be found
below:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"> %block positions_abs
</span><span id="__span-0-2"> C 10.90 10.0 0.000
</span><span id="__span-0-3"> C 13.58 10.0 0.000
</span><span id="__span-0-4"> H 7.50 10.0 2.327
</span><span id="__span-0-5"> C 9.56 10.0 2.327
</span><span id="__span-0-6"> C 14.93 10.0 2.327
</span><span id="__span-0-7"> H 16.99 10.0 2.327
</span><span id="__span-0-8"> %endblock positions_abs
</span></code></pre></div></td></tr></table></div>
<p>To generate an appropriate input file, copy the above primitive unit cell block into a new input
file called <code>ribbon.dat</code>. ONETEP does not make use of any <em>k</em>-point sampling and all calculations
are effectively done at the <span class="arithmatex">\(\Gamma\)</span>-point. Therefore, in order to accurately simulate periodic structures
it is necessary to simulate supercells rather than primitive cells as would be done in standard
plane wave DFT codes. An appropriate supercell from the above primitive cell can be created by
repeating the primitive cell 7 times along the z-axis, translating the z-coordinates of the atoms
by the lattice vector of the primitive unit cell. The resulting supercell should contain 48 atoms
in total.</p>
<p>Now create an appropriate <code>%block lattice_cart</code> for the system. The length of the supercell is
specified by the length of your primitive cell and the number of repeats of that cell. However,
the size of the unit cell in the x and y direction is free to specify by the user. Since the ONETEP
method uses periodic boundary conditions in all three directions, it is necessary to include enough
vacuum in the x and y direction of the simulation cell to prevent it from interacting with its
periodic neighbours. In this case, about 20 a<sub>0</sub> of vacuum between any atoms of different periodic
images is a reasonable length.</p>
<p>Using the lessons learnt from previous tutorials add a <code>%block species</code> and <code>%block species_pot</code>
block to your input file. Choose an appropriate NGWF radius (try 8 a<sub>0</sub>) and kinetic energy cutoff
(around 600 eV) for your calculation. When choosing the NGWF radius, note that ONETEP will
not allow you to pick an NGWF diameter that is larger than the dimensions of your simulation
cell, as this would cause an NGWF to interact with its periodic image. Finally, perform a
singlepoint calculation of the system. You can add a keyword <code>do_properties: T</code> to the input
file. This will trigger the code to perform a properties calculation, write out a file <code>.val_bands</code>
containing all Kohn-Sham energies and write cube files of selected Kohn-Sham states around the
band gap.</p>
<h3 id="conduction-optimisation">Conduction optimisation<a class="headerlink" href="#conduction-optimisation" title="Permanent link">¶</a></h3>
<p>Once the ground state calculation is finished, it is necessary to perform a conduction optimisation.
First, set <code>Task: Cond</code> and add a new block <code>%block species_cond</code> to the input file. This block
is made up in an identical way as <code>%block species</code> and specifies the number of support functions
and their radius in the conduction optimisation. In many practical examples, it is often advisable
to choose a larger NGWF radius for the conduction optimisation than for the ground state
calculation, especially if one is interested in lightly bound states, as unoccupied Kohn-Sham
states tend to be more diffuse than occupied ones (try 10 a<sub>0</sub> for example).</p>
<p>A second keyword required for the conduction optimisation is the number of conduction states
that should be explicitly optimised (<code>cond_num_states</code>). It is normally advisable to optimise only
well-bound states as unbound states are difficult to describe with localised orbitals. In order to do
so, have a look at the file <code>.val_bands</code> and count the number of Kohn-Sham states with negative
energy that are unoccupied. Note that <code>cond_num_states</code> expects the number of electrons to be
optimised as an input, thus in order to optimise the five lowest unoccupied Kohn-Sham states in
a spin-degenerate system, one should choose <code>cond_num_states: 10</code>.</p>
<p>Once you have run the calculation, have a look at the output. You will find that ONETEP
has generated a number of files such as cube files of unoccupied Kohn-Sham states expressed in
terms of the optimised conduction NGWFs.</p>
<h3 id="tddft-calculation">TDDFT calculation<a class="headerlink" href="#tddft-calculation" title="Permanent link">¶</a></h3>
<p>We can now perform a full ONETEP TDDFT calculation of the system at hand. To do so, set
<code>Task: Lr_tddft</code> in the input file. Furthermore, add the keywords <code>lr_tddft_num_states: 6</code>,
<code>lr_tddft_write_densities: T</code> and <code>lr_tddft_analysis: T</code>. The code will compute the lowest 8 singlet excitations of the system and generate cube files for the electron, hole and transition
density for each excitation that can be visualised. Furthermore <code>lr_tddft_analysis: T</code> triggers
a breakdown of the converged TDDFT eigenvectors into Kohn-Sham transitions, allowing you
to study which are the dominant transitions for each excitations.</p>
<p>Once you have performed the TDDFT calculation, look at the output file. You will see that the
excitation energies and oscillator strengths for each of the excitations are printed out, as well as
a detailed breakdown of excitation energies into Kohn-Sham transtions. Have a look at some of
the cube files produced. Where are the excitations located in the system?</p>
<h3 id="nitrogen-substitution">Nitrogen substitution<a class="headerlink" href="#nitrogen-substitution" title="Permanent link">¶</a></h3>
<p>We can now move on from the case of the pristine nanoribbon to one with two nitrogen substitutions. 
For this purpose, copy the input file <code>ribbon.dat</code> to a new file <code>ribbon_NN.dat</code>. In that file,
remove two C-H from the <code>%block positions_abs</code> that are opposite to each other in the ribbon,
and replace them by two N at the same positions where the C were located.</p>
<figure>
<p><img _="," alt="image-1" class="center" src="../files/nanoribbon.png" width="40%"/>
</p>
<figcaption>Left: Pristine nanoribbon. Right: Nanoribbon with two carbons and two hydrogens substituted for two nitrogens.</figcaption>
</figure>
<p>Note that in order to run the calculation, you will have to add the nitrogen species to the 
<code>%block species_pot</code>, <code>%block species</code> and <code>%block species_cond</code> blocks. 
Change the task to <code>Task: Singlepoint Cond Lr_tddft</code>.
The code will run a ground state and conduction optimisation, followed by a TDDFT calculation for the full system.
Have a look at the output. How do the excited states change due to the nitrogen substitutions? 
Where is each excited state located within the system?</p>
<h2 id="additional-tasks">Additional tasks<a class="headerlink" href="#additional-tasks" title="Permanent link">¶</a></h2>
<p>Substituting nitrogen atoms in the same place as carbon atoms does not yield a relaxed ground
state structure, as the N-C bond is not of the same length as the C-C bond. Thus in order to
obtain more realistic results for the substituted system, perform a geometry optimisation (see
tutorial 4), followed by a ground state, conduction and TDDFT calculation of the full system.
How do the results change? Furthermore, create a system where the nitrogen atoms are not
substituted at exactly opposite positions in the structure, but an asymmetry along the z-axis is
introduced. How does the character of the low energy excitations change?</p>
<h2 id="input-files">Input files<a class="headerlink" href="#input-files" title="Permanent link">¶</a></h2>
<p>All the files needed for the simulation can be downloaded from:</p>
<ul>
<li><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span><a href="../files/ribbon_pristine.dat">ribbon_pristine.dat</a></li>
<li><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span><a href="../files/ribbon_pristine_NN.dat">ribbon_pristine_NN.dat</a></li>
<li><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span><a href="../files/ribbon_pristine.out">ribbon_pristine.out</a></li>
<li><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span><a href="../files/ribbon_pristine_NN.out">ribbon_pristine_NN.out</a></li>
<li><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span><a href="../files/carbon.recpot">carbon.recpot</a></li>
<li><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span><a href="../files/hydrogen.recpot">hydrogen.recpot</a></li>
<li><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span><a href="../files/nitrogen.recpot">nitrogen.recpot</a></li>
</ul>

</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 2024 ONETEP Collective
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.c011b7c0.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../../assets/javascripts/bundle.7389ff0e.min.js"></script>
<script src="../../../javascripts/mathjax.js"></script>
<script src="../../../javascripts/mkdocs_exporter.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
<script src="../../../javascripts/katex.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
</body>
</html>